<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <title>Stylesheet documentation for: cavafySearch.xsl</title>
      <link rel="stylesheet" href="docHtml.css" type="text/css" /><script type="text/javascript">
         <!--
        
        var parametersBoxes= new Array('prs_T_generateSearchStringS_cavafySearch.xsl', 
				'prs_T_checkResultS_cavafySearch.xsl', 
				'prs_T_pageResultsS_cavafySearch.xsl', 
				'prs_T_findCavafyXMLsS_cavafySearch.xsl', 
				'prs_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl', 
				'prs_T_generatePbCoreCollectionS_cavafySearch.xsl', 
				'prs_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl', 
				'prs_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl', 
				'prs_T_findSeriesXMLS_cavafySearch.xsl', 
				'prs_T_findSeriesXMLFromNameS_cavafySearch.xsl', 
				'prs_T_generateNextFilenameS_cavafySearch.xsl', 
				'prs_T_findInstantiationS_cavafySearch.xsl', 
				'prs_T_earliestDateS_cavafySearch.xsl', 
				'prs_T_nextInstantiationIDS_cavafySearch.xsl', 
				'prs_T_anniversariesS_cavafySearch.xsl', 
				'prs_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl', 
				'prs_M_pbcoreDescriptionDocumentM_maxInstantiationIDS_cavafySearch.xsl', 
				'prs_M_pbpbcoreCollectionM_importReadyS_cavafySearch.xsl', 
				'prs_M_pbpbcoreDescriptionDocumentM_importReadyS_cavafySearch.xsl', 
				'prs_T_shortenTitleS_cavafySearch.xsl');

        
        var usedByBoxes= new Array('uB_T_generateSearchStringS_cavafySearch.xsl', 
				'uB_T_checkResultS_cavafySearch.xsl', 
				'uB_T_pageResultsS_cavafySearch.xsl', 
				'uB_T_findCavafyXMLsS_cavafySearch.xsl', 
				'uB_T_generatePbCoreCollectionS_cavafySearch.xsl', 
				'uB_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl', 
				'uB_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl', 
				'uB_T_findSeriesXMLS_cavafySearch.xsl', 
				'uB_T_findSeriesXMLFromNameS_cavafySearch.xsl', 
				'uB_T_findInstantiationS_cavafySearch.xsl', 
				'uB_T_earliestDateS_cavafySearch.xsl', 
				'uB_T_nextInstantiationIDS_cavafySearch.xsl', 
				'uB_T_anniversariesS_cavafySearch.xsl', 
				'uB_P_cavafyValidatingStringS_cavafySearch.xsl', 
				'uB_P_separatingTokenS_cavafySearch.xsl', 
				'uB_P_separatingTokenLongS_cavafySearch.xsl', 
				'uB_P_acceptedSearchFieldsS_cavafySearch.xsl');

        var docBoxes= new Array('dS_cavafySearch.xsl');

        var sourceBoxes= new Array('src_M_pma_xml_exportS_cavafySearch.xsl', 
				'src_T_generateSearchStringS_cavafySearch.xsl', 
				'src_T_checkResultS_cavafySearch.xsl', 
				'src_T_pageResultsS_cavafySearch.xsl', 
				'src_T_findCavafyXMLsS_cavafySearch.xsl', 
				'src_M_urlS_cavafySearch.xsl', 
				'src_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl', 
				'src_M_dcurlS_cavafySearch.xsl', 
				'src_T_generatePbCoreCollectionS_cavafySearch.xsl', 
				'src_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl', 
				'src_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl', 
				'src_T_findSeriesXMLS_cavafySearch.xsl', 
				'src_T_findSeriesXMLFromNameS_cavafySearch.xsl', 
				'src_T_generateNextFilenameS_cavafySearch.xsl', 
				'src_T_findInstantiationS_cavafySearch.xsl', 
				'src_T_earliestDateS_cavafySearch.xsl', 
				'src_T_nextInstantiationIDS_cavafySearch.xsl', 
				'src_T_anniversariesS_cavafySearch.xsl', 
				'src_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl', 
				'src_M_pbcoreDescriptionDocumentM_maxInstantiationIDS_cavafySearch.xsl', 
				'src_M_pbpbcoreCollectionM_importReadyS_cavafySearch.xsl', 
				'src_M_pbpbcoreDescriptionDocumentM_importReadyS_cavafySearch.xsl', 
				'src_M_pbpbcoreInstantiationM_importReadyS_cavafySearch.xsl', 
				'src_T_shortenTitleS_cavafySearch.xsl', 
				'src_P_cavafyValidatingStringS_cavafySearch.xsl', 
				'src_P_separatingTokenS_cavafySearch.xsl', 
				'src_P_separatingTokenLongS_cavafySearch.xsl', 
				'src_P_acceptedSearchFieldsS_cavafySearch.xsl', 
				'src_P_todaysDateS_cavafySearch.xsl', 
				'src_O_S_cavafySearch.xsl');

        var supersedesBoxes= new Array('sps_M_pma_xml_exportS_cavafySearch.xsl', 
				'sps_P_separatingTokenS_cavafySearch.xsl', 
				'sps_P_separatingTokenLongS_cavafySearch.xsl', 
				'sps_P_todaysDateS_cavafySearch.xsl');

        var overridingBoxes= new Array('ovr_P_todaysDateS_cavafySearch.xsl');

        var referencesBoxes= new Array('refs_M_pma_xml_exportS_cavafySearch.xsl', 
				'refs_T_generateSearchStringS_cavafySearch.xsl', 
				'refs_T_checkResultS_cavafySearch.xsl', 
				'refs_T_pageResultsS_cavafySearch.xsl', 
				'refs_T_findCavafyXMLsS_cavafySearch.xsl', 
				'refs_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl', 
				'refs_T_generatePbCoreCollectionS_cavafySearch.xsl', 
				'refs_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl', 
				'refs_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl', 
				'refs_T_findSeriesXMLS_cavafySearch.xsl', 
				'refs_T_findSeriesXMLFromNameS_cavafySearch.xsl', 
				'refs_T_generateNextFilenameS_cavafySearch.xsl', 
				'refs_T_findInstantiationS_cavafySearch.xsl', 
				'refs_T_nextInstantiationIDS_cavafySearch.xsl', 
				'refs_T_anniversariesS_cavafySearch.xsl', 
				'refs_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl', 
				'refs_T_shortenTitleS_cavafySearch.xsl', 
				'refs_P_separatingTokenLongS_cavafySearch.xsl');

        var importsBoxes= new Array('ip_cavafySearch.xsl');

        
        var importedFromBoxes= new Array('ipF_cavafySearch.xsl');

        
        var button_prefix = 'bt_';
        
        /**
        * Get all DIV elements with a specified class name.
        *
        * @param className The class name. 
        */
        function getElementsByClassName(className) {
            var results = [];
    
             if (document.getElementsByClassName == undefined) {
                var allElements = document.getElementsByTagName("div");
                var element;
                for (var i = 0; i < allElements.length; i++) {
                    var element = allElements[i];
                	var elementClass = element.className;
                	if (elementClass == className) { 
                		results.push(element);
                	}
                }
             } else {
                results = document.getElementsByClassName(className);
             }
    
            return results;
        }
            
        /**
        * Returns an element in the current HTML document.
        *
        * @param elementID Identifier of HTML element
        * @return               HTML element object
        */
        function getElementObject(elementID) {
            var elemObj = null;
            if (document.getElementById) {
                elemObj = document.getElementById(elementID);
            }
            return elemObj;
        }
        
        /**
        * Switches the state of a collapseable box, e.g.
        * if it's opened, it'll be closed, and vice versa.
        *
        * @param boxID Identifier of box
        */
        function switchState(boxID) {
            var boxObj = getElementObject(boxID);
            var buttonObj = getElementObject(button_prefix + boxID);
            if (boxObj == null || buttonObj == null) {
                // Box or button not found
            } else if (boxObj.style.display == "none") {
                // Box is closed, so open it
                openBox(boxObj, buttonObj);
            } else if (boxObj.style.display == "block") {
                // Box is opened, so close it
                closeBox(boxObj, buttonObj);
            }
        }
        
        /**
        * Opens a collapseable box.
        *
        * @param boxObj       Collapseable box
        * @param buttonObj Button controlling box
        */
        function openBox(boxObj, buttonObj) {
            if (boxObj == null || buttonObj == null) {
                // Box or button not found
            } else {
                // Change 'display' CSS property of box
                boxObj.style.display = "block";
                
                // Change text of button
                if (boxObj.style.display == "block") {
                    buttonObj.src = "img/btM.gif";
                }
            }
        }
        
        /**
        * Closes a collapseable box.
        *
        * @param boxObj       Collapseable box
        * @param buttonObj Button controlling box
        */
        function closeBox(boxObj, buttonObj) {
            if (boxObj == null || buttonObj == null) {
                // Box or button not found
            } else {
                // Change 'display' CSS property of box
                boxObj.style.display = "none";
                
                // Change text of button
                if (boxObj.style.display == "none") {
                    buttonObj.src = "img/btP.gif";
                }
            }
        }

       /**
        * Switch between the compact list representation and the clasic list representation.
        */
       function switchMode(checkBox) {
            if (checkBox == null) {
                // Checkbox not found
            } else if (checkBox.checked == 1) {
                // Compact mode
                var divs = getElementsByClassName('refItemBlock');
                for (var i = 0; i < divs.length; i ++) {
                    divs[i].style.display = "inline";
                    var children = divs[i].children;
                    var refItemSep = children[children.length - 1];
                    if (refItemSep.className == "refItemSep") {
                        children[children.length - 1].style.display = "inline";
                    }
                }
            } else {
                // Expanded mode
                var divs = getElementsByClassName('refItemBlock');
                for (var i = 0; i < divs.length; i ++) {
                    divs[i].style.display = "block";
                    var children = divs[i].children;
                    var refItemSep = children[children.length - 1];
                    if (refItemSep.className == "refItemSep") {
                        children[children.length - 1].style.display = "none";
                    }
                }
            }
        }

       function switchStateForAll(buttonObj, boxList) {
            if (buttonObj == null) {
                // button not found
            } else if (buttonObj.value == "+") {
                // Expand all
                expandAll(boxList);
                buttonObj.value = "-";
            } else if (buttonObj.value == "-") {
                // Collapse all
                collapseAll(boxList);
                buttonObj.value = "+";
            }
        }
        
        /**
        * Closes all boxes in a given list.
        *
        * @param boxList Array of box IDs
        */
        function collapseAll(boxList) {
            var idx;
            for (idx = 0; idx < boxList.length; idx++) {
                var boxObj = getElementObject(boxList[idx]);
                var buttonObj = getElementObject(button_prefix + boxList[idx]);
                closeBox(boxObj, buttonObj);
            }
        }
            
        /**
        * Open all boxes in a given list.
        *
        * @param boxList Array of box IDs
        */
        function expandAll(boxList) {
            var idx;
            for (idx = 0; idx < boxList.length; idx++) {
                var boxObj = getElementObject(boxList[idx]);
                var buttonObj = getElementObject(button_prefix + boxList[idx]);
                openBox(boxObj, buttonObj);
            }
        }
        
        /**
         * Update the message presented in the title of the html page.
         * - If the documentation was splited by namespace we present something like: "Documentation for namespace 'ns'"
         * - If the documentation was splited by location we present somehing like: "Documentation for 'Schema.xsd'"
         * - If no split we always present: "Documentation for 'MainSchema.xsd'"
         */
        function updPT(message) {
            top.document.title = "Stylesheet documentation for: " + message;
        }
        
          
                    
         /**
          * Finds an HTML element by its ID and makes it floatable over the normal content.
          *
          * @param x_displacement The difference in pixels to the right side of the window from 
          *           the left side of the element.
          * @param y_displacement The difference in pixels to the right side of the window from 
          *           the top of the element.          
          */
         function findAndFloat(id, x_displacement, y_displacement){

            var element = getElementObject(id);            
            
            window[id + "_obj"] = element;
            
            if(document.layers) {
               element.style = element;
            }
            
            element.current_y = y_displacement;      
            element.first_time = true;
         
            element.floatElement = function(){
               // It may be closed by an user action.
                
               // Target X and Y coordinates.
               var x, y;
               
               var myWidth = 0, myHeight = 0;
               if( typeof( window.innerWidth ) == 'number' ) {
                  //Non-IE
                  myWidth = window.innerWidth;
                  myHeight = window.innerHeight;
               } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {
                  //IE 6+ in 'standards compliant mode'
                  myWidth = document.documentElement.clientWidth;
                  myHeight = document.documentElement.clientHeight;
               } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {
                  //IE 4 compatible
                  myWidth = document.body.clientWidth;
                  myHeight = document.body.clientHeight;
               }
               
               
               x = myWidth - x_displacement;
               
               var ns = (navigator.appName.indexOf("Netscape") != -1);               
               y = ns ? pageYOffset : document.documentElement && document.documentElement.scrollTop ? 
                  document.documentElement.scrollTop : document.body.scrollTop;               
               y = y + y_displacement;               
               
               // The current y is the current coordinate of the floating element.
               // This should be at the limit the y target coordinate.
               this.current_y += (y - this.current_y)/1.25;
               
               // Add the pixels constant after the values
               // and move the element.
               var px = document.layers ? "" : "px";
               this.style.left =  x + px;
               this.style.top =  this.current_y + px;
                              
               setTimeout(this.id + "_obj.floatElement()", 100);
            }
            
            element.floatElement();
            return element;
          }

         /**
          * Finds an HTML element by its ID and makes it floatable over the normal content.
          *
          * @param x_displacement The difference in pixels to the right side of the window from 
          *           the left side of the element.
          * @param y_displacement The difference in pixels to the right side of the window from 
          *           the top of the element.          
          */
         function selectTOCGroupBy(id){
         var selectIds = new Array('toc_group_by_location', 'toc_group_by_component_type', 'toc_group_by_namespace', 'toc_group_by_mode');
            // Make all the tabs invisible.
            for (i = 0; i < 4; i++){
               var tab = getElementObject(selectIds[i]);
               tab.style.display = 'none';
            }
            var selTab = getElementObject(id);
            selTab.style.display = 'block';            
         }
          

    
                    //--></script></head>
   <body>
      <div id="global_controls" class="globalControls" style="position:absolute;right:0;">
         <table class="rt">
            <tr>
               <td class="rt_cTL"></td>
               <td class="rt_lT"></td>
               <td class="rt_cTR"></td>
            </tr>
            <tr>
               <td class="rt_lL"></td>
               <td class="rt_cnt">
                  <h3>Mode:</h3>
                  <table>
                     <tr>
                        <td><span><input type="checkbox" value="-" checked="checked" onclick="switchMode(this);" class="control" /></span><span class="globalControlName">Compact lists</span></td>
                     </tr>
                  </table>
                  <h3>Showing:</h3>
                  <table>
                     <tr>
                        <td><span><input type="checkbox" value="-" checked="checked" onclick="switchStateForAll(this, docBoxes);" class="control" /></span><span class="globalControlName">Documentation
                              </span></td>
                     </tr>
                     <tr>
                        <td><span><input type="checkbox" value="-" checked="checked" onclick="switchStateForAll(this, parametersBoxes);" class="control" /></span><span class="globalControlName">Parameters </span></td>
                     </tr>
                     <tr>
                        <td><span><input type="checkbox" value="-" checked="checked" onclick="switchStateForAll(this, usedByBoxes);" class="control" /></span><span class="globalControlName">Used by </span></td>
                     </tr>
                     <tr>
                        <td><span><input type="checkbox" value="-" checked="checked" onclick="switchStateForAll(this, referencesBoxes);" class="control" /></span><span class="globalControlName">References </span></td>
                     </tr>
                     <tr>
                        <td><span><input type="checkbox" value="-" checked="checked" onclick="switchStateForAll(this, supersedesBoxes);" class="control" /></span><span class="globalControlName">Supersedes </span></td>
                     </tr>
                     <tr>
                        <td><span><input type="checkbox" value="-" checked="checked" onclick="switchStateForAll(this, overridingBoxes);" class="control" /></span><span class="globalControlName">Overriding </span></td>
                     </tr>
                     <tr>
                        <td><span><input type="checkbox" value="-" checked="checked" onclick="switchStateForAll(this, importsBoxes);" class="control" /></span><span class="globalControlName">Imported modules
                              </span></td>
                     </tr>
                     <tr>
                        <td><span><input type="checkbox" value="-" checked="checked" onclick="switchStateForAll(this, importedFromBoxes);" class="control" /></span><span class="globalControlName">Imported from
                              </span></td>
                     </tr>
                     <tr>
                        <td><span><input type="checkbox" value="-" checked="checked" onclick="switchStateForAll(this, sourceBoxes);" class="control" /></span><span class="globalControlName">Source </span></td>
                     </tr>
                  </table>
                  <div align="right"><span><input type="button" onclick="getElementObject('global_controls').style.display = 'none';" value="Close" /></span></div>
               </td>
               <td class="rt_lR"></td>
            </tr>
            <tr>
               <td class="rt_cBL"></td>
               <td class="rt_lB"></td>
               <td class="rt_cBR"></td>
            </tr>
         </table>
      </div><a id="cavafySearch.xsl"></a><div class="cmpT">Stylesheet
         <span class="qname">cavafySearch.xsl</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Documentation</div>
                           <div class="flR"><input id="bt_dS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('dS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="dS_cavafySearch.xsl" style="display:block">
                              <div>
                                 <h3>Description</h3><pre>    
    1. Accept cavafy search parameters
    2. Generate a cavafy API search string of the type
https://cavafy.wnyc.org/?facet_Collection%5B%5D=CMS&amp;facet_Contributor%5B%5D=La+Guardia%2C+Fiorello+H.+%28Fiorello+Henry%29%2C+1882-1947&amp;facet_Genre%5B%5D=Speech&amp;facet_Location%5B%5D=Archives+Storage&amp;facet_Series+Title%5B%5D=Talk+to+the+People&amp;facet_Subject%5B%5D=Social+sciences&amp;page=3&amp;q=la+guardia&amp;search_fields%5B%5D=contributor
https://cavafy.wnyc.org/?facet_Collection%5B%5D=CMS&amp;facet_Contributor%5B%5D=La+Guardia%2C+Fiorello+H.+%28Fiorello+Henry%29%2C+1882-1947&amp;facet_Genre%5B%5D=Speech&amp;facet_Location%5B%5D=Archives+Storage&amp;facet_Series+Title%5B%5D=Talk+to+the+People&amp;facet_Subject%5B%5D=Social+sciences&amp;page=3&amp;q=la+guardia
    3. Output fields 
    corresponding to each of the resulting asset results.

Cavafy's RESTful API search string consists of 
    1. https://cavafy.wnyc.org/?
    2. facets
    3. page number
    4. text to search...
    5. ...in specific fields.

Make sure your are parameters in percent-encoded!! 
https://www.url-encode-decode.com/
</pre></div>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Imported modules</div>
                           <div class="flR"><input id="bt_ip_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('ip_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="ip_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter17.html#manageDuplicates.xsl" target="_self" title="No namespace" onclick="updPT('manageDuplicates.xsl')">manageDuplicates.xsl</a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Imported from</div>
                           <div class="flR"><input id="bt_ipF_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('ipF_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="ipF_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter4.html#Exif2Slack.xsl" target="_self" title="No namespace" onclick="updPT('Exif2Slack.xsl')">Exif2Slack.xsl</a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter2.html#Exif2html.xsl" target="_self" title="No namespace" onclick="updPT('Exif2html.xsl')">Exif2html.xsl</a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter15.html#cavafyQC.xsl" target="_self" title="No namespace" onclick="updPT('cavafyQC.xsl')">cavafyQC.xsl</a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Stylesheet version</td>
                        <td>3.0</td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="M_pma_xml_exportS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">pma_xml_export</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>pma_xml_export</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>#default</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_M_pma_xml_exportS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_M_pma_xml_exportS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_M_pma_xml_exportS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Parameter</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_separatingTokenLongS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">separatingTokenLong</a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Supersedes</div>
                           <div class="flR"><input id="bt_sps_M_pma_xml_exportS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('sps_M_pma_xml_exportS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="sps_M_pma_xml_exportS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter16.html#M_pma_xml_exportS_processLoCURL.xsl" target="_self" title="No namespace" onclick="updPT('processLoCURL.xsl')"><span class="mRf">pma_xml_export</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_M_pma_xml_exportS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_M_pma_xml_exportS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_M_pma_xml_exportS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> match=</span><span class="tAV">"pma_xml_export"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Process an xml export from cavafy's phpMyAdmin that includes urls --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"urls"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tEl">&lt;dc:url</span><span class="tEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                         database/table/column[@name = 'url']"</span><span class="tAN"> separator=</span><span class="tAV">"                 {$separatingTokenLong}"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tEl">&lt;/dc:url&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"newSoundsDupes"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:apply-templates</span><span class="tAN"> select=</span><span class="tAV">"$urls"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"newSoundsDupesDuplicated"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy</span><span class="tAN"> select=</span><span class="tAV">"$newSoundsDupes/pb:pbcoreCollection"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"$newSoundsDupes/*:pbcoreCollection/*:pbcoreDescriptionDocument"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"newAssetID"</span><span class="tAN"> select=</span><span class="tAV">"86536 + position()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:copy</span><span class="tXSLEl">&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:comment</span><span class="tAN"> select=</span><span class="tAV">"'************ORIGINAL ', *:pbcoreIdentifier[@source = 'WNYC Archive Catalog'], '**********'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"*"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;/xsl:copy&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:copy</span><span class="tXSLEl">&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:comment</span><span class="tAN"> select=</span><span class="tAV">"'++++++++++++++++NEW ', $newAssetID, '++++++++++++++'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"*[following-sibling::*:pbcoreIdentifier[@source = 'WNYC Archive Catalog']]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tEl">&lt;pbcoreIdentifier</span><span class="tAN"> source=</span><span class="tAV">"WNYC Archive Catalog"</span><span class="tEl">&gt;</span><span class="tI">
            </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$newAssetID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tEl">&lt;/pbcoreIdentifier&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"*[preceding-sibling::*:pbcoreIdentifier[@source = 'WNYC Archive Catalog']]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;/xsl:copy&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:copy&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:apply-templates</span><span class="tAN"> select=</span><span class="tAV">"$newSoundsDupesDuplicated"</span><span class="tAN"> mode=</span><span class="tAV">"importReady"</span><span class="tXSLEl">/&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_generateSearchStringS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">.</span><span class="titleTemplateName">generateSearchString</span><span class="titleTemplateMode">generateSearchString</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>.</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>generateSearchString</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_generateSearchStringS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_generateSearchStringS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_generateSearchStringS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findCavafyXMLsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findCavafyXMLs</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSeriesXMLFromNameS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSeriesXMLFromName</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSpecificCavafyAssetXML</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSpecificNewSoundsProgramNoXML</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_generateSearchStringS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_generateSearchStringS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_generateSearchStringS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Parameters</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_acceptedSearchFieldsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">acceptedSearchFields</a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_separatingTokenS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">separatingToken</a></div>
                                       </div>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">Function</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter19.html#F_splitParseValidateS_utilities.xsl" target="_self" title="http://www.wnyc.org" onclick="updPT('utilities.xsl')"><span>splitParseValidate (</span><span class="fParams">input, separatingToken, validatingString</span><span>)</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_generateSearchStringS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_generateSearchStringS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_generateSearchStringS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">appendSearchFieldString</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">completeSearchString</td>
                                    <td>No namespace</td>
                                    <td>                 translate(                 concat(                 'https://cavafy.wnyc.org/?',
                                       $facetsSearchString,                 $textSearchString                 ),        
                                       ' ', '+'                 )
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">contributor</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">coverage</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">facetsSearchMessage</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">facetsSearchString</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">field1ToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">field2ToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">genre</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">isPartOf</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">location</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">searchTextMessage</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">series</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">subject</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">textSearchString</td>
                                    <td>No namespace</td>
                                    <td>             concat(             '&amp;q=',              $textToSearch,              $appendSearchFieldString
                                       )
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">textToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_generateSearchStringS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_generateSearchStringS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_generateSearchStringS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"generateSearchString"</span><span class="tAN"> match=</span><span class="tAV">"."</span><span class="tAN"> mode=</span><span class="tAV">"generateSearchString"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Generate a cavafy search string
        from given parameters --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"textToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"field1ToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"field2ToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"searchTextMessage"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                     'Generate search string for text _', $textToSearch,                     '_ in fields ',                     $field1ToSearch, $field2ToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Limiting facets in the search --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"isPartOf"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- The 'collection' facet in cavafy
            actually looks for relations of type "is part of"--&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"series"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"subject"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"genre"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"coverage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"contributor"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"location"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"facetsSearchMessage"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                     'Generate search string',                     'for a search in cavafy',                     'with the following parameters: ',                     '- relations is part of: ', $isPartOf[. != ''],                     '- series: ', $series,                     '- subject: ', $subject,                     '- genre: ', $genre,                     '- coverage: ', $coverage,                     '- contributor: ', $contributor,                     '- location: ', $location"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"facetsSearchString"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$isPartOf"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('&amp;facet_Collection%5B%5D=', $contributor)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$series"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('&amp;facet_Series+Title%5B%5D=', $series)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$subject"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('&amp;facet_Subject%5B%5D=', $subject)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$genre"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('&amp;facet_Genre%5B%5D=', $genre)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$coverage"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('&amp;facet_Genre%5B%5D=', $coverage)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$contributor"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('&amp;facet_Contributor%5B%5D=', $contributor)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$location"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('&amp;facet_Location%5B%5D=', $location)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"appendSearchFieldString"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"normalize-space($field1ToSearch)"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"                         WNYC:splitParseValidate($field1ToSearch, $separatingToken, '')                         /valid                         [translate(lower-case(normalize-space(.)), ' ', '+') = $acceptedSearchFields//*:acceptedSearchField]                         "</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('&amp;search_fields%5B%5D=', $field1ToSearch)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"normalize-space($field2ToSearch)"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"                         WNYC:splitParseValidate($field2ToSearch, $separatingToken, '')                         /valid                         [translate(lower-case(.), ' ', '+') = $acceptedSearchFields//*:acceptedSearchField]"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('&amp;search_fields%5B%5D=',                          translate(lower-case(.), ' ', '+'))"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"textSearchString"</span><span class="tAN"> select=</span><span class="tAV">"             concat(             '&amp;q=',              $textToSearch,              $appendSearchFieldString             )"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Convert spaces to plus signs --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"completeSearchString"</span><span class="tAN"> select=</span><span class="tAV">"                 translate(                 concat(                 'https://cavafy.wnyc.org/?',                 $facetsSearchString,                 $textSearchString                 ),                 ' ', '+'                 )"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$searchTextMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$facetsSearchMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 'Complete search string: ',                 $completeSearchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tEl">&lt;completeSearchString</span><span class="tEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$completeSearchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tEl">&lt;/completeSearchString&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_checkResultS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">searchString[starts-with(., 'https://cavafy.wnyc.org/?')]</span><span class="titleTemplateName">checkResult</span><span class="titleTemplateMode">checkResult</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>searchString[starts-with(., 'https://cavafy.wnyc.org/?')]</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>checkResult</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_checkResultS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_checkResultS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_checkResultS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_anniversariesS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">anniversaries</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findCavafyXMLsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findCavafyXMLs</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_checkResultS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_checkResultS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_checkResultS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_pageResultsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">pageResults</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_checkResultS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_checkResultS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_checkResultS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                       <th>Type</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">htmlResult</td>
                                    <td>No namespace</td>
                                    <td>document($searchString)</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">maxResults</td>
                                    <td>No namespace</td>
                                    <td>1000</td>
                                    <td>xs:integer</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">minResults</td>
                                    <td>No namespace</td>
                                    <td>1</td>
                                    <td>xs:integer</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">searchString</td>
                                    <td>No namespace</td>
                                    <td>.[starts-with(., 'https://cavafy.wnyc.org/?')]</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">stopIfTooFew</td>
                                    <td>No namespace</td>
                                    <td>false()</td>
                                    <td>xs:boolean</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">stopIfTooMany</td>
                                    <td>No namespace</td>
                                    <td>false()</td>
                                    <td>xs:boolean</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_checkResultS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_checkResultS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_checkResultS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"checkResult"</span><span class="tAN"> match=</span><span class="tAV">"searchString[starts-with(., 'https://cavafy.wnyc.org/?')]"</span><span class="tAN"> mode=</span><span class="tAV">"checkResult"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Retrieve and compile 
            paginated url results 
            from a cavafy search string --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tAN"> select=</span><span class="tAV">".[starts-with(., 'https://cavafy.wnyc.org/?')]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"minResults"</span><span class="tAN"> as=</span><span class="tAV">"xs:integer"</span><span class="tAN"> select=</span><span class="tAV">"1"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"maxResults"</span><span class="tAN"> as=</span><span class="tAV">"xs:integer"</span><span class="tAN"> select=</span><span class="tAV">"1000"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooMany"</span><span class="tAN"> as=</span><span class="tAV">"xs:boolean"</span><span class="tAN"> select=</span><span class="tAV">"false()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooFew"</span><span class="tAN"> as=</span><span class="tAV">"xs:boolean"</span><span class="tAN"> select=</span><span class="tAV">"false()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"htmlResult"</span><span class="tAN"> select=</span><span class="tAV">"document($searchString)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"'htmlResult: ', $htmlResult"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$htmlResult/html/head/title[contains(., 'Sign in')]"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> terminate=</span><span class="tAV">"yes"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"'Please log into cavafy.wnyc.org'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:message&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$minResults gt $maxResults"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> terminate=</span><span class="tAV">"yes"</span><span class="tAN"> select=</span><span class="tAV">"                     'ERROR: ',                     'Your min results (', $minResults, ')',                     'are bigger than your max results (', $maxResults, ').'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"totalResults"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"number(                     $htmlResult                     /xhtml:html/xhtml:head/xhtml:meta                     [@name = 'totalResults']                     /@content)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"itemsPerPage"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"number(                     $htmlResult                     /xhtml:html/xhtml:head/xhtml:meta                     [@name = 'itemsPerPage']                     /@content)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"totalPages"</span><span class="tAN"> select=</span><span class="tAV">"$totalResults                 div                 $itemsPerPage                 "</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"resultsMessage"</span><span class="tAN"> select=</span><span class="tAV">"                 concat(                 $totalResults, ' results',                 ' from search string ', $searchString, '.',                 ' Allowed range: ', $minResults, '-', $maxResults,                 'Items Per Page: ', $itemsPerPage,                 'Total Pages: ', ceiling($totalPages)                 )                 "</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:choose</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:when</span><span class="tAN"> test=</span><span class="tAV">"$totalResults &lt; $minResults"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> terminate=</span><span class="tAV">"{$stopIfTooFew}"</span><span class="tAN"> select=</span><span class="tAV">"'ATTENTION!', $resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"'too_few_cavafy_results'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:when&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:when</span><span class="tAN"> test=</span><span class="tAV">"$totalResults &gt; $maxResults"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> terminate=</span><span class="tAV">"{$stopIfTooMany}"</span><span class="tAN"> select=</span><span class="tAV">"'ATTENTION!', $resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"'too_many_cavafy_results'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:when&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:otherwise</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:comment</span><span class="tAN"> select=</span><span class="tAV">"$resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tEl">&lt;searchResults</span><span class="tEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tAN"> select=</span><span class="tAV">"$searchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"totalResults"</span><span class="tAN"> select=</span><span class="tAV">"$totalResults"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"pageResults"</span><span class="tXSLEl">&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"pageNumber"</span><span class="tAN"> select=</span><span class="tAV">"1"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tAN"> select=</span><span class="tAV">"$searchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"totalPages"</span><span class="tAN"> select=</span><span class="tAV">"$totalPages"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
      </span><span class="tEl">&lt;/searchResults&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:otherwise&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:choose&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_pageResultsS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateName">pageResults</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_pageResultsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_pageResultsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_pageResultsS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_checkResultS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">checkResult</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_pageResultsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">pageResults</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_pageResultsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_pageResultsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_pageResultsS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_pageResultsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">pageResults</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_pageResultsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_pageResultsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_pageResultsS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">pageNumber</td>
                                    <td>No namespace</td>
                                    <td>1</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">pageSearchString</td>
                                    <td>No namespace</td>
                                    <td>concat('&amp;page=', $pageNumber)</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">searchString</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">totalPages</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_pageResultsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_pageResultsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_pageResultsS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"pageResults"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Retrieve the asset URLs
            from the html pages 
            with the search results --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"pageNumber"</span><span class="tAN"> select=</span><span class="tAV">"1"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"pageSearchString"</span><span class="tAN"> select=</span><span class="tAV">"concat('&amp;page=', $pageNumber)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"totalPages"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"searchStringWithPage"</span><span class="tAN"> select=</span><span class="tAV">"concat($searchString, $pageSearchString)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"searchResult"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"document($searchStringWithPage)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                     'Now searching page ', $pageNumber,                     '... Using search ', $searchStringWithPage                     "</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:message&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Navigate the html document
        to find the listed assets' URLs --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"                 $searchResult                 /xhtml:html/xhtml:body                 /xhtml:table/xhtml:tr                 /xhtml:td/xhtml:table                 /xhtml:tr/xhtml:td                 /xhtml:div/xhtml:div                 /xhtml:h2/xhtml:a                 /@href"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"'cavafy url found: ', string(.)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tEl">&lt;url</span><span class="tEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tEl">&lt;/url&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('Page number ', $pageNumber, ' of ', $totalPages, ' completed.')"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:message&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"number($pageNumber) &lt; number($totalPages)"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"pageResults"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tAN"> select=</span><span class="tAV">"$searchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"pageNumber"</span><span class="tAN"> select=</span><span class="tAV">"number(number($pageNumber) + 1)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"totalPages"</span><span class="tAN"> select=</span><span class="tAV">"$totalPages"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_findCavafyXMLsS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">.</span><span class="titleTemplateName">findCavafyXMLs</span><span class="titleTemplateMode">findCavafyXMLs</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>.</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>findCavafyXMLs</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_findCavafyXMLsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_findCavafyXMLsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_findCavafyXMLsS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSeriesXMLFromNameS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSeriesXMLFromName</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSpecificCavafyAssetXML</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSpecificNewSoundsProgramNoXML</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_findCavafyXMLsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_findCavafyXMLsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_findCavafyXMLsS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_checkResultS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">checkResult</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generatePbCoreCollectionS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generatePbCoreCollection</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateSearchStringS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateSearchString</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">Parameter</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_separatingTokenLongS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">separatingTokenLong</a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_findCavafyXMLsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_findCavafyXMLsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_findCavafyXMLsS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                       <th>Type</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">cavafyURLs</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">contributor</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">coverage</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">field1ToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">field2ToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">genre</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">isPartOf</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">location</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">maxResults</td>
                                    <td>No namespace</td>
                                    <td>1000</td>
                                    <td>xs:integer</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">message</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">minResults</td>
                                    <td>No namespace</td>
                                    <td>1</td>
                                    <td>xs:integer</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">searchString</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">series</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">stopIfTooFew</td>
                                    <td>No namespace</td>
                                    <td>false()</td>
                                    <td>xs:boolean</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">stopIfTooMany</td>
                                    <td>No namespace</td>
                                    <td>false()</td>
                                    <td>xs:boolean</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">subject</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">textToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">urls</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_findCavafyXMLsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_findCavafyXMLsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_findCavafyXMLsS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"findCavafyXMLs"</span><span class="tAN"> match=</span><span class="tAV">"."</span><span class="tAN"> mode=</span><span class="tAV">"findCavafyXMLs"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Obtain the cavafy XMLs 
        from a search using specific parameters.--&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Inputs: 
            1. A string to search in cavafy
            plus two fields in which to search
            for that string
            2. Several facets to limit that search
            such as collection, series or subjects.
            
            Output:
            The cavafy xmls for each record found.
         --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"textToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"field1ToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"field2ToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"isPartOf"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Called 'Collection' in cavafy --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"series"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"subject"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"genre"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"contributor"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"location"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"coverage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"generateSearchString"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"textToSearch"</span><span class="tAN"> select=</span><span class="tAV">"$textToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"field1ToSearch"</span><span class="tAN"> select=</span><span class="tAV">"$field1ToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"field2ToSearch"</span><span class="tAN"> select=</span><span class="tAV">"$field2ToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"isPartOf"</span><span class="tAN"> select=</span><span class="tAV">"$isPartOf"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"series"</span><span class="tAN"> select=</span><span class="tAV">"$series"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"subject"</span><span class="tAN"> select=</span><span class="tAV">"$subject"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"genre"</span><span class="tAN"> select=</span><span class="tAV">"$genre"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"contributor"</span><span class="tAN"> select=</span><span class="tAV">"$contributor"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"location"</span><span class="tAN"> select=</span><span class="tAV">"$location"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"coverage"</span><span class="tAN"> select=</span><span class="tAV">"$coverage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"minResults"</span><span class="tAN"> as=</span><span class="tAV">"xs:integer"</span><span class="tAN"> select=</span><span class="tAV">"1"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"maxResults"</span><span class="tAN"> as=</span><span class="tAV">"xs:integer"</span><span class="tAN"> select=</span><span class="tAV">"1000"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooMany"</span><span class="tAN"> as=</span><span class="tAV">"xs:boolean"</span><span class="tAN"> select=</span><span class="tAV">"false()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooFew"</span><span class="tAN"> as=</span><span class="tAV">"xs:boolean"</span><span class="tAN"> select=</span><span class="tAV">"false()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"cavafyURLs"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"checkResult"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tAN"> select=</span><span class="tAV">"$searchString[contains(., 'https://cavafy.wnyc.org/')]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"minResults"</span><span class="tAN"> select=</span><span class="tAV">"$minResults"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"maxResults"</span><span class="tAN"> select=</span><span class="tAV">"$maxResults"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooMany"</span><span class="tAN"> select=</span><span class="tAV">"$stopIfTooMany"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooFew"</span><span class="tAN"> select=</span><span class="tAV">"$stopIfTooFew"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"urls"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$cavafyURLs/*:searchResults/*:url"</span><span class="tAN"> separator=</span><span class="tAV">"{$separatingTokenLong}"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"message"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                 'Find between', $minResults, ' and ', $maxResults,                 'cavafy XMLs'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"' with parameters ',                 $textToSearch, $series, $subject, $contributor,                  $genre, $isPartOf, $location"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                 ' within fields ', $field1ToSearch, $field2ToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                 ' using search string ', $searchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"'Result URLs: ', $cavafyURLs"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$message"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"$cavafyURLs[//local-name() = 'error']"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"generatePbCoreCollection"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"urls"</span><span class="tAN"> select=</span><span class="tAV">"$urls"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="M_urlS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">url</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>url</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>#default</td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_M_urlS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_M_urlS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_M_urlS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> match=</span><span class="tAV">"url"</span><span class="tAN"> xpath-default-namespace=</span><span class="tAV">"http://www.pbcore.org/PBCore/PBCoreNamespace.html"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:apply-templates</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tAN"> mode=</span><span class="tAV">"generatePbCoreCollectionWRepeats"</span><span class="tXSLEl">/&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">url</span><span class="titleTemplateName">generatePbCoreCollectionWRepeats</span><span class="titleTemplateMode">generatePbCoreCollectionWRepeats</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>url</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>generatePbCoreCollectionWRepeats</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Parameter</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_separatingTokenS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">separatingToken</a></div>
                                       </div>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generatePbCoreDescriptionDocument</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">urls</td>
                                    <td>No namespace</td>
                                    <td>.</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"generatePbCoreCollectionWRepeats"</span><span class="tAN"> match=</span><span class="tAV">"url"</span><span class="tAN"> mode=</span><span class="tAV">"generatePbCoreCollectionWRepeats"</span><span class="tAN"> xpath-default-namespace=</span><span class="tAV">"http://www.pbcore.org/PBCore/PBCoreNamespace.html"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- From a token-separated list of URLs,
        generate a pbcore collection
        of xmls including repeats --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"urls"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 'From a token-separated list of URLs, ',                 'generate a pbcore collection of xmls ',                 'including repeats'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"pbcoreCollection"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:namespace</span><span class="tAN"> name=</span><span class="tAV">"xsi"</span><span class="tAN"> select=</span><span class="tAV">"'http://www.w3.org/2001/XMLSchema-instance'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"xsi:schemaLocation"</span><span class="tAN"> select=</span><span class="tAV">"'http://pbcore.org/PBCore/PBCoreNamespace.html http://pbcore.org/xsd/pbcore-2.0.xsd'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"                     tokenize($urls, $separatingToken)"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"generatePbCoreDescriptionDocument"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"url"</span><span class="tAN"> select=</span><span class="tAV">"normalize-space(.)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="M_dcurlS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">dc:url</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>dc:url</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>#default</td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_M_dcurlS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_M_dcurlS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_M_dcurlS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> match=</span><span class="tAV">"dc:url"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Process a set of urls 
        result of a mySQL search
        and exported as xml --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:apply-templates</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tAN"> mode=</span><span class="tAV">"generatePbCoreCollection"</span><span class="tXSLEl">/&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_generatePbCoreCollectionS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">dc:url</span><span class="titleTemplateName">generatePbCoreCollection</span><span class="titleTemplateMode">generatePbCoreCollection</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>dc:url</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>generatePbCoreCollection</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_generatePbCoreCollectionS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_generatePbCoreCollectionS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_generatePbCoreCollectionS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findCavafyXMLsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findCavafyXMLs</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_generatePbCoreCollectionS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_generatePbCoreCollectionS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_generatePbCoreCollectionS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Parameters</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_cavafyValidatingStringS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">cavafyValidatingString</a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_separatingTokenS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">separatingToken</a></div>
                                       </div>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">Function</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter19.html#F_splitParseValidateS_utilities.xsl" target="_self" title="http://www.wnyc.org" onclick="updPT('utilities.xsl')"><span>splitParseValidate (</span><span class="fParams">input, separatingToken, validatingString</span><span>)</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generatePbCoreDescriptionDocument</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_generatePbCoreCollectionS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_generatePbCoreCollectionS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_generatePbCoreCollectionS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">urls</td>
                                    <td>No namespace</td>
                                    <td>.</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_generatePbCoreCollectionS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_generatePbCoreCollectionS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_generatePbCoreCollectionS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"generatePbCoreCollection"</span><span class="tAN"> match=</span><span class="tAV">"dc:url"</span><span class="tAN"> mode=</span><span class="tAV">"generatePbCoreCollection"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- From a token-separated list of URLs,
        generate a pbcore collection
        of UNIQUE xmls ready for import --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"urls"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 'From a token-separated list of URLs, ',                 'generate a pbcore collection of unique xmls ',                 'ready for import: '"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$urls"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:message&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"                 WNYC:splitParseValidate($urls, $separatingToken, $cavafyValidatingString)                 /invalid"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"                         'invalid_cavafy_URL'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"pbcoreCollection"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:namespace</span><span class="tAN"> name=</span><span class="tAV">"xsi"</span><span class="tAN"> select=</span><span class="tAV">"'http://www.w3.org/2001/XMLSchema-instance'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"xsi:schemaLocation"</span><span class="tAN"> select=</span><span class="tAV">"'http://pbcore.org/PBCore/PBCoreNamespace.html http://pbcore.org/xsd/pbcore-2.0.xsd'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"                     WNYC:splitParseValidate($urls, ';', $cavafyValidatingString)                     /valid"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"generatePbCoreDescriptionDocument"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"url"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">dc:url</span><span class="titleTemplateName">generatePbCoreDescriptionDocument</span><span class="titleTemplateMode">generatePbCoreDescriptionDocument</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>dc:url</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>generatePbCoreDescriptionDocument</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generatePbCoreCollectionS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generatePbCoreCollection</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generatePbCoreCollectionWRepeats</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Parameters</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_cavafyValidatingStringS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">cavafyValidatingString</a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_separatingTokenS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">separatingToken</a></div>
                                       </div>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">Function</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter19.html#F_splitParseValidateS_utilities.xsl" target="_self" title="http://www.wnyc.org" onclick="updPT('utilities.xsl')"><span>splitParseValidate (</span><span class="fParams">input, separatingToken, validatingString</span><span>)</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">url</td>
                                    <td>No namespace</td>
                                    <td>.</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"generatePbCoreDescriptionDocument"</span><span class="tAN"> match=</span><span class="tAV">"dc:url"</span><span class="tAN"> mode=</span><span class="tAV">"generatePbCoreDescriptionDocument"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- From a single cavafy URL,
        generate a pbcore description document 
        --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"url"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Reject non-cavafy URLs --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"                 WNYC:splitParseValidate($url, $separatingToken, $cavafyValidatingString)                 /invalid                 |                 WNYC:splitParseValidate($url, $separatingToken, $cavafyValidatingString)                 /valid[not(starts-with(., $cavafyValidatingString))]"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"'invalid_cavafy_URL'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"                 WNYC:splitParseValidate($url, ';', $cavafyValidatingString)                 /valid[starts-with(., $cavafyValidatingString)][ends-with(., '.xml')]"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"document(.)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"                 WNYC:splitParseValidate($url, ';', $cavafyValidatingString)                 /valid[starts-with(., $cavafyValidatingString)][not(ends-with(., '.xml'))]"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"document(concat(., '.xml'))"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_findSpecificCavafyAssetXMLS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">.</span><span class="titleTemplateName">findSpecificCavafyAssetXML</span><span class="titleTemplateMode">findSpecificCavafyAssetXML</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>.</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>findSpecificCavafyAssetXML</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findInstantiationS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findInstantiation</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSeriesXMLS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSeriesXML</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateNextFilenameS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateNextFilename</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_nextInstantiationIDS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">nextInstantiationID</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter12.html#T_parseDAVIDTitleS_parseDAVIDTitle.xsl" target="_self" title="No namespace" onclick="updPT('parseDAVIDTitle.xsl')"><span class="nRf">parseDAVIDTitle</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findCavafyXMLsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findCavafyXMLs</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateSearchStringS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateSearchString</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                       <th>Type</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">additionalFieldsToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">additionalTextToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">assetID</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">contributor</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">coverage</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">genre</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">isPartOf</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">location</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">searchString</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">series</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">stopIfTooFew</td>
                                    <td>No namespace</td>
                                    <td>false()</td>
                                    <td>xs:boolean</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">stopIfTooMany</td>
                                    <td>No namespace</td>
                                    <td>false()</td>
                                    <td>xs:boolean</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">subject</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">textToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"findSpecificCavafyAssetXML"</span><span class="tAN"> match=</span><span class="tAV">"."</span><span class="tAN"> mode=</span><span class="tAV">"findSpecificCavafyAssetXML"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Search for records with specific Asset ID 
        (which should be unique) --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"additionalTextToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"textToSearch"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$assetID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$additionalTextToSearch"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('+', $additionalTextToSearch)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"additionalFieldsToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"isPartOf"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"series"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"subject"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"genre"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"contributor"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"location"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"coverage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"generateSearchString"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"textToSearch"</span><span class="tAN"> select=</span><span class="tAV">"$textToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"field1ToSearch"</span><span class="tAN"> select=</span><span class="tAV">"'identifier'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"field2ToSearch"</span><span class="tAN"> select=</span><span class="tAV">"$additionalFieldsToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"isPartOf"</span><span class="tAN"> select=</span><span class="tAV">"$isPartOf"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"series"</span><span class="tAN"> select=</span><span class="tAV">"$series"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"subject"</span><span class="tAN"> select=</span><span class="tAV">"$subject"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"genre"</span><span class="tAN"> select=</span><span class="tAV">"$genre"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"contributor"</span><span class="tAN"> select=</span><span class="tAV">"$contributor"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"location"</span><span class="tAN"> select=</span><span class="tAV">"$location"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"coverage"</span><span class="tAN"> select=</span><span class="tAV">"$coverage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooMany"</span><span class="tAN"> as=</span><span class="tAV">"xs:boolean"</span><span class="tAN"> select=</span><span class="tAV">"false()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooFew"</span><span class="tAN"> as=</span><span class="tAV">"xs:boolean"</span><span class="tAN"> select=</span><span class="tAV">"false()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 'Search for records with specific Asset ID ',                 string($assetID), ' (which should be unique)'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Initial cavafy search --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"foundAssets"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"findCavafyXMLs"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tAN"> select=</span><span class="tAV">"$searchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"minResults"</span><span class="tAN"> select=</span><span class="tAV">"1"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"maxResults"</span><span class="tAN"> select=</span><span class="tAV">"20"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 'Found assets', $foundAssets"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"matchingAssets"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"                     $foundAssets/*:pbcoreCollection/*:pbcoreDescriptionDocument                     [*:pbcoreIdentifier[@source = 'WNYC Archive Catalog'] = $assetID]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"resultsCount"</span><span class="tAN"> select=</span><span class="tAV">"                 count(                 $matchingAssets                 /*:pbcoreDescriptionDocument                 )"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"resultsMessage"</span><span class="tAN"> select=</span><span class="tAV">"                 concat($resultsCount, ' matching assets ',                 'with asset ID ', $assetID,                 ' using search string ', $searchString, ': '),                 $matchingAssets"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Errors when not a single matching asset --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:choose</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:when</span><span class="tAN"> test=</span><span class="tAV">"$resultsCount &lt; 1"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"'no_matching_asset'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tAN"> select=</span><span class="tAV">"$assetID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"$resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:when&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:when</span><span class="tAN"> test=</span><span class="tAV">"$resultsCount &gt; 1"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"'too_many__matching_assets'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tAN"> select=</span><span class="tAV">"$assetID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"                             'ATTENTION!',                             $resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:when&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:otherwise</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"$matchingAssets"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:otherwise&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:choose&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_findSeriesXMLS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">seriesAcronym</span><span class="titleTemplateName">findSeriesXML</span><span class="titleTemplateMode">findSeriesXML</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>seriesAcronym</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>findSeriesXML</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_findSeriesXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_findSeriesXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_findSeriesXMLS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter12.html#T_parseDAVIDTitleS_parseDAVIDTitle.xsl" target="_self" title="No namespace" onclick="updPT('parseDAVIDTitle.xsl')"><span class="nRf">parseDAVIDTitle</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_findSeriesXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_findSeriesXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_findSeriesXMLS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSpecificCavafyAssetXML</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_findSeriesXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_findSeriesXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_findSeriesXMLS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">message</td>
                                    <td>No namespace</td>
                                    <td>                 concat(                 'Find the series data in cavafy ',      
                                       'from the series acronym ', $seriesAcronym                 )
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">seriesAcronym</td>
                                    <td>No namespace</td>
                                    <td>.</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_findSeriesXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_findSeriesXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_findSeriesXMLS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"findSeriesXML"</span><span class="tAN"> match=</span><span class="tAV">"seriesAcronym"</span><span class="tAN"> mode=</span><span class="tAV">"findSeriesXML"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Find the series info in cavafy
        from the series acronym --&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Series information is stored in cavafy
                with a relation 'SRSLST' 
                of relationType 'other'.            
            It includes default hosts, 
            genres and subject headings --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"seriesAcronym"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"message"</span><span class="tAN"> select=</span><span class="tAV">"                 concat(                 'Find the series data in cavafy ',                 'from the series acronym ', $seriesAcronym                 )"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$message"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"seriesSearchResult"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"findSpecificCavafyAssetXML"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"textToSearch"</span><span class="tAN"> select=</span><span class="tAV">"concat('SRSLST+', $seriesAcronym)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tAN"> select=</span><span class="tAV">"$seriesAcronym"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"additionalFieldsToSearch"</span><span class="tAN"> select=</span><span class="tAV">"'relation'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:choose</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:when</span><span class="tAN"> test=</span><span class="tAV">"$seriesSearchResult[//*:error[@type = 'no_matching_asset']]"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"noSeriesFound"</span><span class="tAN"> select=</span><span class="tAV">"'No series found with acronym ', $seriesAcronym"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$noSeriesFound"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"'no_series_found'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$noSeriesFound"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:when&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:when</span><span class="tAN"> test=</span><span class="tAV">"$seriesSearchResult[//*:error[@type = 'too_many_matching_assets']]"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"multipleSeriesFound"</span><span class="tAN"> select=</span><span class="tAV">"'Multiple series found with acronym ', $seriesAcronym"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$multipleSeriesFound"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"'multiple_series_found'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$multipleSeriesFound"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:when&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:otherwise</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"$seriesSearchResult"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:otherwise&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:choose&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_findSeriesXMLFromNameS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">seriesName</span><span class="titleTemplateName">findSeriesXMLFromName</span><span class="titleTemplateMode">findSeriesXMLFromName</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>seriesName</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>findSeriesXMLFromName</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_findSeriesXMLFromNameS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_findSeriesXMLFromNameS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_findSeriesXMLFromNameS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter15.html#T_defaultValuesWarningS_cavafyQC.xsl" target="_self" title="No namespace" onclick="updPT('cavafyQC.xsl')"><span class="nRf">defaultValuesWarning</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateNextFilenameS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateNextFilename</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_findSeriesXMLFromNameS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_findSeriesXMLFromNameS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_findSeriesXMLFromNameS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findCavafyXMLsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findCavafyXMLs</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateSearchStringS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateSearchString</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_findSeriesXMLFromNameS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_findSeriesXMLFromNameS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_findSeriesXMLFromNameS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">message</td>
                                    <td>No namespace</td>
                                    <td>                 'Find the series info in cavafy',                 'from the series
                                       name ', $seriesName
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">seriesName</td>
                                    <td>No namespace</td>
                                    <td>'New Sounds'</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_findSeriesXMLFromNameS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_findSeriesXMLFromNameS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_findSeriesXMLFromNameS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"findSeriesXMLFromName"</span><span class="tAN"> match=</span><span class="tAV">"seriesName"</span><span class="tAN"> mode=</span><span class="tAV">"findSeriesXMLFromName"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Find the series info in cavafy
        from the series name --&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Series information is stored in cavafy
                with a relation 'SRSLST' 
                of relationType 'other'.            
            It includes default hosts, 
            genres and subject headings --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"seriesName"</span><span class="tAN"> select=</span><span class="tAV">"'New Sounds'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"message"</span><span class="tAN"> select=</span><span class="tAV">"                 'Find the series info in cavafy',                 'from the series name ', $seriesName"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$message"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"generateSearchString"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"textToSearch"</span><span class="tAN"> select=</span><span class="tAV">"concat('SRSLST+', $seriesName)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"field1ToSearch"</span><span class="tAN"> select=</span><span class="tAV">"'title'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"field2ToSearch"</span><span class="tAN"> select=</span><span class="tAV">"'relation'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"series"</span><span class="tAN"> select=</span><span class="tAV">"$seriesName"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"findCavafyXMLs"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tAN"> select=</span><span class="tAV">"$searchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"minResults"</span><span class="tAN"> select=</span><span class="tAV">"1"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"maxResults"</span><span class="tAN"> select=</span><span class="tAV">"1"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooFew"</span><span class="tAN"> select=</span><span class="tAV">"true()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooMany"</span><span class="tAN"> select=</span><span class="tAV">"true()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_generateNextFilenameS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">         instantiationID |          pb:instantiationIdentifier         [@source =
            'WNYC Media Archive Label']</span><span class="titleTemplateName">generateNextFilename</span><span class="titleTemplateMode">generateNextFilename</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>         instantiationID |          pb:instantiationIdentifier         [@source =
                           'WNYC Media Archive Label']
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>generateNextFilename</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_generateNextFilenameS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_generateNextFilenameS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_generateNextFilenameS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter18.html#T_abbreviateTextS_trimStrings.xsl" target="_self" title="No namespace" onclick="updPT('trimStrings.xsl')"><span class="nRf">abbreviateText</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_earliestDateS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">earliestDate</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findInstantiationS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findInstantiation</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSeriesXMLFromNameS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSeriesXMLFromName</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSpecificCavafyAssetXML</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_nextInstantiationIDS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">nextInstantiationID</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_generateNextFilenameS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_generateNextFilenameS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_generateNextFilenameS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">assetID</td>
                                    <td>No namespace</td>
                                    <td>             $instantiationIDParsed/instantiationIDParsed/assetID</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">collection</td>
                                    <td>No namespace</td>
                                    <td>                 $foundAsset/pb:pbcoreDescriptionDocument                 /pb:pbcoreTitle[@titleType
                                       = 'Collection']
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">filenameDate</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">foundAsset</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">foundInstantiation</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">freeTextComplete</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">freeTextInsert</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">freeTextOtherAssetIDs</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">freeTextShortenedTitle</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationID</td>
                                    <td>No namespace</td>
                                    <td>.</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationIDParsed</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationIDwOutSuffixSegment</td>
                                    <td>No namespace</td>
                                    <td>             $instantiationIDParsed/instantiationIDParsed/             instantiationIDwOutSuffixSegment</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationSegmentSuffix</td>
                                    <td>No namespace</td>
                                    <td>             $instantiationIDParsed/instantiationIDParsed/             instantiationSegmentSuffix</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationSuffixDigit</td>
                                    <td>No namespace</td>
                                    <td>                 $instantiationIDParsed/instantiationIDParsed/                 instantiationSuffixDigit</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">nextInstantiationID</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">precedingSiblingLevelsCount</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">precedingSiblings</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">seriesAcronym</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">seriesXML</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_generateNextFilenameS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_generateNextFilenameS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_generateNextFilenameS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"generateNextFilename"</span><span class="tAN"> match=</span><span class="tAV">"         instantiationID |          pb:instantiationIdentifier         [@source = 'WNYC Media Archive Label']"</span><span class="tAN"> mode=</span><span class="tAV">"generateNextFilename"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationID"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationIDParsed"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:apply-templates</span><span class="tAN"> select=</span><span class="tAV">"$instantiationID"</span><span class="tAN"> mode=</span><span class="tAV">"parseInstantiationID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tAN"> select=</span><span class="tAV">"             $instantiationIDParsed/instantiationIDParsed/assetID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationSuffixDigit"</span><span class="tAN"> select=</span><span class="tAV">"                 $instantiationIDParsed/instantiationIDParsed/                 instantiationSuffixDigit"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationSegmentSuffix"</span><span class="tAN"> select=</span><span class="tAV">"             $instantiationIDParsed/instantiationIDParsed/             instantiationSegmentSuffix"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationIDwOutSuffixSegment"</span><span class="tAN"> select=</span><span class="tAV">"             $instantiationIDParsed/instantiationIDParsed/             instantiationIDwOutSuffixSegment"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"precedingSiblings"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tC">&lt;!-- Preceding instantiations
            from same asset in this document --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"                 preceding-sibling::instantiationID                 [starts-with(., concat($assetID, '.'))]                 [not(starts-with(., $instantiationIDwOutSuffixSegment))]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"precedingSiblingLevelsCount"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tC">&lt;!-- Count of preceding instantiation levels
            (defined as 
            a group of one or more instantiations 
            sharing the same numeric ID, 
            e.g. 1234.5a and 1234.5b 
            are two instantiations 
            at the same level, 
            but 1234.5a and 1234.6
            are in two levels) --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                     count(distinct-values(                     $precedingSiblings//instantiationID/analyze-string(., '[a-zA-Z]'                     )/*:non-match))"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"foundAsset"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"findSpecificCavafyAssetXML"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tAN"> select=</span><span class="tAV">"$assetID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"foundInstantiation"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"findInstantiation"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"instantiationID"</span><span class="tAN"> select=</span><span class="tAV">"$instantiationID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"cavafyEntry"</span><span class="tAN"> select=</span><span class="tAV">"$foundAsset"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"overwriteError"</span><span class="tAN"> select=</span><span class="tAV">"false()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"collection"</span><span class="tAN"> select=</span><span class="tAV">"                 $foundAsset/pb:pbcoreDescriptionDocument                 /pb:pbcoreTitle[@titleType = 'Collection']"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"seriesXML"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"findSeriesXMLFromName"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"seriesName"</span><span class="tAN"> select=</span><span class="tAV">"                         $foundAsset/pb:pbcoreDescriptionDocument                         /pb:pbcoreTitle[@titleType = 'Series']"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"seriesAcronym"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                 $seriesXML//pb:pbcoreIdentifier                 [@source = 'WNYC Archive Catalog']"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"filenameDate"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"earliestDate"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"cavafyXML"</span><span class="tAN"> select=</span><span class="tAV">"$foundAsset/pb:pbcoreDescriptionDocument"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"nextInstantiationID"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"nextInstantiationID"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"instantiationID"</span><span class="tAN"> select=</span><span class="tAV">"                         $instantiationID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"foundAsset"</span><span class="tAN"> select=</span><span class="tAV">"                         $foundAsset"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"instantiationIDOffset"</span><span class="tAN"> select=</span><span class="tAV">"                     number($precedingSiblingLevelsCount)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"freeTextInsert"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"freeTextOtherAssetIDs"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                     $foundAsset/pb:pbcoreDescriptionDocument/                     pb:pbcoreIdentifier                     [@source != 'WNYC Archive Catalog']                     [@source != 'pbcore XML database UUID']"</span><span class="tAN"> separator=</span><span class="tAV">" "</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"freeTextShortenedTitle"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tC">&lt;!-- A shortened version of the title --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"abbreviatedText"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"abbreviateText"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"maxTitleLength"</span><span class="tAN"> select=</span><span class="tAV">"                             50"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"text"</span><span class="tAN"> select=</span><span class="tAV">"                             $foundAsset/pb:pbcoreDescriptionDocument/                             pb:pbcoreTitle[@titleType = 'Episode']"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$abbreviatedText/abbreviatedText"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"freeTextComplete"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                     normalize-space(                     string-join(                     ($freeTextInsert, $freeTextOtherAssetIDs, $freeTextShortenedTitle), ' '))"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"'PREVIOUS INSTANTIATION LEVELS FOR', $instantiationID, ':', $precedingSiblingLevelsCount"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"nextFilenameNoFreeText"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                     concat(                     $collection, '-',                     $seriesAcronym, '-',                     $filenameDate, '-',                     $assetID, '.',                     $nextInstantiationID,                     $instantiationSegmentSuffix,                     ' SEGMENT'[$instantiationSegmentSuffix != ''])"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"newFreeText"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"abbreviateText"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"maxTitleLength"</span><span class="tAN"> select=</span><span class="tAV">"                         80 - string-length($nextFilenameNoFreeText)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"text"</span><span class="tAN"> select=</span><span class="tAV">"$freeTextComplete"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"newFilename"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                     string-join(                     ($nextFilenameNoFreeText,                     $freeTextComplete), ' ')"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tEl">&lt;inputs</span><span class="tEl">&gt;</span><span class="tI">
    </span><span class="tEl">&lt;originalInstantiationID</span><span class="tEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$instantiationID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tEl">&lt;/originalInstantiationID&gt;</span><span class="tI">
    </span><span class="tEl">&lt;cavafyEntry</span><span class="tEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"$foundAsset"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tEl">&lt;/cavafyEntry&gt;</span><span class="tI">
    </span><span class="tEl">&lt;parsedDAVIDTitle</span><span class="tEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"DAVIDTitle"</span><span class="tAN"> select=</span><span class="tAV">"$newFilename"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tEl">&lt;parsedElements</span><span class="tEl">&gt;</span><span class="tI">
        </span><span class="tEl">&lt;seriesData</span><span class="tEl">&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"$seriesXML"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tEl">&lt;/seriesData&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"$foundInstantiation"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tEl">&lt;/parsedElements&gt;</span><span class="tI">
    </span><span class="tEl">&lt;/parsedDAVIDTitle&gt;</span><span class="tI">
  </span><span class="tEl">&lt;/inputs&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_findInstantiationS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">instantiationID</span><span class="titleTemplateName">findInstantiation</span><span class="titleTemplateMode">processInstantiation</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>instantiationID</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>processInstantiation</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_findInstantiationS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_findInstantiationS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_findInstantiationS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateNextFilenameS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateNextFilename</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter12.html#T_parseDAVIDTitleS_parseDAVIDTitle.xsl" target="_self" title="No namespace" onclick="updPT('parseDAVIDTitle.xsl')"><span class="nRf">parseDAVIDTitle</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_findInstantiationS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_findInstantiationS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_findInstantiationS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSpecificCavafyAssetXML</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_findInstantiationS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_findInstantiationS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_findInstantiationS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">assetID</td>
                                    <td>No namespace</td>
                                    <td>                 substring-before($instantiationID, '.')</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">cavafyEntry</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">format</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationID</td>
                                    <td>No namespace</td>
                                    <td>.</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationSuffix</td>
                                    <td>No namespace</td>
                                    <td>substring-after($instantiationID, '.')</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">overwriteError</td>
                                    <td>No namespace</td>
                                    <td>true()</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">translatedFormat</td>
                                    <td>No namespace</td>
                                    <td>                 if (upper-case($format) = 'WAV')                 then           
                                       'BWF'                 else                     $format
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_findInstantiationS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_findInstantiationS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_findInstantiationS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"findInstantiation"</span><span class="tAN"> match=</span><span class="tAV">"instantiationID"</span><span class="tAN"> mode=</span><span class="tAV">"processInstantiation"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Find a specific instantiationID in cavafy --&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- NOTE: mode "processInstantiation"
        is part of a set
        along with template
        "nextInstantiationID"--&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"overwriteError"</span><span class="tAN"> select=</span><span class="tAV">"true()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationID"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tAN"> select=</span><span class="tAV">"                 substring-before($instantiationID, '.')"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"cavafyEntry"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"findSpecificCavafyAssetXML"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tAN"> select=</span><span class="tAV">"$assetID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationSuffix"</span><span class="tAN"> select=</span><span class="tAV">"substring-after($instantiationID, '.')"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"format"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"translatedFormat"</span><span class="tAN"> select=</span><span class="tAV">"                 if (upper-case($format) = 'WAV')                 then                     'BWF'                 else                     $format"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 concat(                 'Find instantiation info for ', $instantiationID,                 ' of format ', $translatedFormat                 )"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"matchedInstantiation"</span><span class="tAN"> select=</span><span class="tAV">"                 $cavafyEntry                 /*:pbcoreDescriptionDocument                 /*:pbcoreInstantiation                 [*:instantiationIdentifier = $instantiationID]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"matchedInstantiationID"</span><span class="tAN"> select=</span><span class="tAV">"                 $matchedInstantiation                 /*:instantiationIdentifier                 [. = $instantiationID]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 count($matchedInstantiation),                 ' instantiations with ID ',                 $instantiationID,                 ' found in cavafy: ',                 $matchedInstantiation                 "</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"matchedInstantiationIDSource"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                     $matchedInstantiationID/@source"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tEl">&lt;instantiationData</span><span class="tEl">&gt;</span><span class="tI">
    </span><span class="tC">&lt;!-- Generate error if
            there is more than one instantiation
            with this ID --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"                     count($matchedInstantiation) gt 1"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"errorMessage"</span><span class="tAN"> select=</span><span class="tAV">"                         'ATTENTION!!!',                         'Instantiation ID ', $instantiationID,                         ' is not unique.'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$errorMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"                             'multiple_instantiation_IDs',                             $instantiationID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$errorMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
    </span><span class="tC">&lt;!--Generate error if instantiation formats do not match --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$matchedInstantiationID"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"matchedInstantiationFormat"</span><span class="tAN"> select=</span><span class="tAV">"                         $matchedInstantiation                         /*:instantiationData                         /*:pbcoreInstantiation                         /(*:instantiationPhysical | *:instantiationDigital)                         [. != '']"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:choose</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:when</span><span class="tAN"> test=</span><span class="tAV">"                             ($matchedInstantiationFormat                             != $translatedFormat) and $overwriteError"</span><span class="tXSLEl">&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"errorMessage"</span><span class="tAN"> select=</span><span class="tAV">"                                 'ATTENTION!!!',                                 ' You are about to wipe out instantiation ',                                 $instantiationID,                                 ', a ', $matchedInstantiationFormat, ', ',                                 ' with a ', $translatedFormat, '!!!'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> terminate=</span><span class="tAV">"no"</span><span class="tAN"> select=</span><span class="tAV">"$errorMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
            </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"'mismatched_format'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
            </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$errorMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;/xsl:when&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:when</span><span class="tAN"> test=</span><span class="tAV">"                             $matchedInstantiationIDSource != 'WNYC Media Archive Label'"</span><span class="tXSLEl">&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"errorMessage"</span><span class="tAN"> select=</span><span class="tAV">"                                 'ATTENTION! ',                                 'Instantiation ID ',                                 $matchedInstantiationID,                                 ' has a nonstandard ID source: ',                                 $matchedInstantiationIDSource,                                 '
',                                 'Please change to WNYC Media Archive Label.'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$errorMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
            </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"                                     'nonstandard_instantiationID_source',                                     $matchedInstantiationID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
            </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$errorMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;/xsl:when&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:otherwise</span><span class="tXSLEl">&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"$matchedInstantiation"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;/xsl:otherwise&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:choose&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
  </span><span class="tEl">&lt;/instantiationData&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_earliestDateS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">*:pbcoreDescriptionDocument</span><span class="titleTemplateName">earliestDate</span><span class="titleTemplateMode">earliestDate</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>*:pbcoreDescriptionDocument</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>earliestDate</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_earliestDateS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_earliestDateS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_earliestDateS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateNextFilenameS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateNextFilename</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_earliestDateS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_earliestDateS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_earliestDateS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">cavafyXML</td>
                                    <td>No namespace</td>
                                    <td>.</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_earliestDateS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_earliestDateS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_earliestDateS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"earliestDate"</span><span class="tAN"> match=</span><span class="tAV">"*:pbcoreDescriptionDocument"</span><span class="tAN"> mode=</span><span class="tAV">"earliestDate"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Find the earliest specific date 
        or the most specific unknown date.
        This is used to generate filename dates.
        We assume that unknown dates
        are always earlier than known dates --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"cavafyXML"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"concat(                 'Find earliest date in asset ',                 $cavafyXML                 /*:pbcoreIdentifier[@source = 'WNYC Archive Catalog'])"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"earliestKnownDate"</span><span class="tAN"> select=</span><span class="tAV">"                 min(                 $cavafyXML/*:pbcoreAssetDate[not(contains(., 'u'))]                 /xs:date(.)                 )"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- The most specific unknown date 
        uses the min() function 
        because numbers come before 'u' --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"mostSpecificUnknownDate"</span><span class="tAN"> select=</span><span class="tAV">"                 min($cavafyXML/*:pbcoreAssetDate[contains(., 'u')]/xs:string(.))"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"filenameDate"</span><span class="tAN"> select=</span><span class="tAV">"                 if ($mostSpecificUnknownDate)                 then                     $mostSpecificUnknownDate                 else                     $earliestKnownDate                 "</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$filenameDate"</span><span class="tXSLEl">/&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_nextInstantiationIDS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">         instantiationID |          pb:instantiationIdentifier         [@source =
            'WNYC Media Archive Label']</span><span class="titleTemplateName">nextInstantiationID</span><span class="titleTemplateMode">processInstantiation</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>         instantiationID |          pb:instantiationIdentifier         [@source =
                           'WNYC Media Archive Label']
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>processInstantiation</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_nextInstantiationIDS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_nextInstantiationIDS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_nextInstantiationIDS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateNextFilenameS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateNextFilename</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_nextInstantiationIDS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_nextInstantiationIDS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_nextInstantiationIDS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findSpecificCavafyAssetXMLS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findSpecificCavafyAssetXML</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_nextInstantiationIDS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_nextInstantiationIDS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_nextInstantiationIDS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">assetID</td>
                                    <td>No namespace</td>
                                    <td>             $instantiationIDParsed/instantiationIDParsed/assetID</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">foundAsset</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationID</td>
                                    <td>No namespace</td>
                                    <td>.</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationIDOffset</td>
                                    <td>No namespace</td>
                                    <td>0</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationIDParsed</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_nextInstantiationIDS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_nextInstantiationIDS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_nextInstantiationIDS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"nextInstantiationID"</span><span class="tAN"> match=</span><span class="tAV">"         instantiationID |          pb:instantiationIdentifier         [@source = 'WNYC Media Archive Label']"</span><span class="tAN"> mode=</span><span class="tAV">"processInstantiation"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Generate the next instantiation ID
            in an asset.
        This is used for generating filenames. --&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- NOTE: mode "processInstantiation"
        is part of a set
        along with template
        "findInstantiation"--&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationID"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationIDOffset"</span><span class="tAN"> select=</span><span class="tAV">"0"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationIDParsed"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:apply-templates</span><span class="tAN"> select=</span><span class="tAV">"$instantiationID"</span><span class="tAN"> mode=</span><span class="tAV">"                 parseInstantiationID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tAN"> select=</span><span class="tAV">"             $instantiationIDParsed/instantiationIDParsed/assetID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"foundAsset"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"findSpecificCavafyAssetXML"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tAN"> select=</span><span class="tAV">"                         substring-before($instantiationID, '.')"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"concat(                 'Find next instantiation ID for ', $instantiationID,                  ' in asset ', $assetID,                 ' with offset of ', $instantiationIDOffset)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"cavafyInstantiationIDsParsed"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:apply-templates</span><span class="tAN"> select=</span><span class="tAV">"$foundAsset                 /pb:pbcoreDescriptionDocument                 /pb:pbcoreInstantiation                 /pb:instantiationIdentifier                 [@source = 'WNYC Media Archive Label']"</span><span class="tAN"> mode=</span><span class="tAV">"                 parseInstantiationID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"'CavafyIDs parsed', $cavafyInstantiationIDsParsed"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"maxCavafyInstantiationID"</span><span class="tAN"> select=</span><span class="tAV">"max             (             $cavafyInstantiationIDsParsed/instantiationIDParsed/instantiationSuffixDigit             )"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$maxCavafyInstantiationID  + $instantiationIDOffset + 1"</span><span class="tXSLEl">/&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_anniversariesS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">.</span><span class="titleTemplateName">anniversaries</span><span class="titleTemplateMode">anniversaries</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>.</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>anniversaries</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_T_anniversariesS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_T_anniversariesS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_T_anniversariesS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter4.html#T_buttonBlockS_Exif2Slack.xsl" target="_self" title="No namespace" onclick="updPT('Exif2Slack.xsl')"><span class="nRf">buttonBlock</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter2.html#M_rdfRDFM_htmlS_Exif2html.xsl" target="_self" title="No namespace" onclick="updPT('Exif2html.xsl')"><span class="mRf">rdf:RDF</span><span class="mdRf">html</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_anniversariesS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_anniversariesS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_anniversariesS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_checkResultS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">checkResult</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_anniversariesS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_anniversariesS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_anniversariesS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">dateXYearsAgo</td>
                                    <td>No namespace</td>
                                    <td>                 concat(                 string($year50YearsAgo),                
                                       '-',                 substring-after($todaysDateFormatted, '-'))
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">todaysDate</td>
                                    <td>No namespace</td>
                                    <td>$todaysDate</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">todaysDateFormatted</td>
                                    <td>No namespace</td>
                                    <td>                 format-date(                 $todaysDate, '[Y0001]-[M01]-[D01]' 
                                       )
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">xYears</td>
                                    <td>No namespace</td>
                                    <td>50</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">xYearsAgoCavafySearchString</td>
                                    <td>No namespace</td>
                                    <td>             concat(             'https://cavafy.wnyc.org/assets?q=',            
                                       $dateXYearsAgo,             '&amp;search_fields%5B%5D=date'             )
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">year50YearsAgo</td>
                                    <td>No namespace</td>
                                    <td>                 year-from-date($todaysDate) - $xYears</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_anniversariesS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_anniversariesS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_anniversariesS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"anniversaries"</span><span class="tAN"> match=</span><span class="tAV">"."</span><span class="tAN"> mode=</span><span class="tAV">"anniversaries"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Find entries in cavafy 
            from x years ago (default 50) --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"todaysDate"</span><span class="tAN"> select=</span><span class="tAV">"$todaysDate"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"xYears"</span><span class="tAN"> select=</span><span class="tAV">"50"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"year50YearsAgo"</span><span class="tAN"> select=</span><span class="tAV">"                 year-from-date($todaysDate) - $xYears"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"todaysDateFormatted"</span><span class="tAN"> select=</span><span class="tAV">"                 format-date(                 $todaysDate, '[Y0001]-[M01]-[D01]'                 )"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"dateXYearsAgo"</span><span class="tAN"> select=</span><span class="tAV">"                 concat(                 string($year50YearsAgo),                 '-',                 substring-after($todaysDateFormatted, '-'))"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"xYearsAgoCavafySearchString"</span><span class="tAN"> select=</span><span class="tAV">"             concat(             'https://cavafy.wnyc.org/assets?q=',             $dateXYearsAgo,             '&amp;search_fields%5B%5D=date'             )"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"xYearsAgoResult"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"checkResult"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tAN"> select=</span><span class="tAV">"$xYearsAgoCavafySearchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">programNo</span><span class="titleTemplateName">findSpecificNewSoundsProgramNoXML</span><span class="titleTemplateMode">findSpecificNewSoundsProgramNoXML</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>programNo</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>findSpecificNewSoundsProgramNoXML</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findCavafyXMLsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findCavafyXMLs</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateSearchStringS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateSearchString</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                       <th>Type</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">additionalFieldsToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">additionalTextToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">contributor</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">coverage</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">genre</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">isPartOf</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">location</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">newSoundsEpisodeID</td>
                                    <td>No namespace</td>
                                    <td>.</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">newSoundsEpisodeIDPadded</td>
                                    <td>No namespace</td>
                                    <td>                 format-number($newSoundsEpisodeID, '0000')</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">searchString</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">series</td>
                                    <td>No namespace</td>
                                    <td>'New Sounds'</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">stopIfTooFew</td>
                                    <td>No namespace</td>
                                    <td>false()</td>
                                    <td>xs:boolean</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">stopIfTooMany</td>
                                    <td>No namespace</td>
                                    <td>false()</td>
                                    <td>xs:boolean</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">subject</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">textToSearch</td>
                                    <td>No namespace</td>
                                    <td></td>
                                    <td></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_findSpecificNewSoundsProgramNoXMLS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"findSpecificNewSoundsProgramNoXML"</span><span class="tAN"> match=</span><span class="tAV">"programNo"</span><span class="tAN"> mode=</span><span class="tAV">"findSpecificNewSoundsProgramNoXML"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Search for records with specific New Sounds Program ID 
        (which should be unique) --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"newSoundsEpisodeID"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"newSoundsEpisodeIDPadded"</span><span class="tAN"> select=</span><span class="tAV">"                 format-number($newSoundsEpisodeID, '0000')"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"additionalTextToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"textToSearch"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$newSoundsEpisodeIDPadded"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:if</span><span class="tAN"> test=</span><span class="tAV">"$additionalTextToSearch"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"concat('+', $additionalTextToSearch)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:if&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"additionalFieldsToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"isPartOf"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"series"</span><span class="tAN"> select=</span><span class="tAV">"'New Sounds'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"subject"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"genre"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"contributor"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"location"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"coverage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"generateSearchString"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"textToSearch"</span><span class="tAN"> select=</span><span class="tAV">"$textToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"field1ToSearch"</span><span class="tAN"> select=</span><span class="tAV">"'identifier'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"field2ToSearch"</span><span class="tAN"> select=</span><span class="tAV">"$additionalFieldsToSearch"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"isPartOf"</span><span class="tAN"> select=</span><span class="tAV">"$isPartOf"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"series"</span><span class="tAN"> select=</span><span class="tAV">"$series"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"subject"</span><span class="tAN"> select=</span><span class="tAV">"$subject"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"genre"</span><span class="tAN"> select=</span><span class="tAV">"$genre"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"contributor"</span><span class="tAN"> select=</span><span class="tAV">"$contributor"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"location"</span><span class="tAN"> select=</span><span class="tAV">"$location"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"coverage"</span><span class="tAN"> select=</span><span class="tAV">"$coverage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooMany"</span><span class="tAN"> as=</span><span class="tAV">"xs:boolean"</span><span class="tAN"> select=</span><span class="tAV">"false()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"stopIfTooFew"</span><span class="tAN"> as=</span><span class="tAV">"xs:boolean"</span><span class="tAN"> select=</span><span class="tAV">"false()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 'Search for records ',                 'with specific New Sounds Episode ID ',                 string($newSoundsEpisodeIDPadded),                 ' (which should be unique)'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Initial cavafy search --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"foundAssets"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"findCavafyXMLs"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"searchString"</span><span class="tAN"> select=</span><span class="tAV">"$searchString"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"minResults"</span><span class="tAN"> select=</span><span class="tAV">"1"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"maxResults"</span><span class="tAN"> select=</span><span class="tAV">"20"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 'Found assets', $foundAssets"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"matchingAssets"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"                     $foundAssets                     /*:pbcoreCollection                     /*:pbcoreDescriptionDocument                     [*:pbcoreIdentifier[@source = 'New Sounds episode ID'] = $newSoundsEpisodeIDPadded]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"resultsCount"</span><span class="tAN"> select=</span><span class="tAV">"                 count(                 $matchingAssets                 //*:pbcoreDescriptionDocument                 )"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"resultsMessage"</span><span class="tAN"> select=</span><span class="tAV">"                 concat($resultsCount, ' matching assets ',                 'with New Sounds episode ID ', $newSoundsEpisodeIDPadded,                 ' using search string ', $searchString, ': '),                 $matchingAssets"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Errors when not a single matching asset --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:choose</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:when</span><span class="tAN"> test=</span><span class="tAV">"$resultsCount &lt; 1"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"'no_matching_asset'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"newSoundsEpisodeID"</span><span class="tAN"> select=</span><span class="tAV">"$newSoundsEpisodeIDPadded"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"                             'ATTENTION!',                             $resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:when&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:when</span><span class="tAN"> test=</span><span class="tAV">"$resultsCount &gt; 1"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:element</span><span class="tAN"> name=</span><span class="tAV">"error"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"type"</span><span class="tAN"> select=</span><span class="tAV">"'too_many__matching_assets'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:attribute</span><span class="tAN"> name=</span><span class="tAV">"newSoundsEpisodeID"</span><span class="tAN"> select=</span><span class="tAV">"$newSoundsEpisodeIDPadded"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"                             'ATTENTION!',                             $resultsMessage"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:element&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:when&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:otherwise</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"$matchingAssets"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:otherwise&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:choose&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="M_pbcoreDescriptionDocumentM_maxInstantiationIDS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">*:pbcoreDescriptionDocument</span><span class="titleTemplateMode">maxInstantiationID</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>*:pbcoreDescriptionDocument</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>maxInstantiationID</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_M_pbcoreDescriptionDocumentM_maxInstantiationIDS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_M_pbcoreDescriptionDocumentM_maxInstantiationIDS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_M_pbcoreDescriptionDocumentM_maxInstantiationIDS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">assetID</td>
                                    <td>No namespace</td>
                                    <td>pbcoreIdentifier[@source = 'WNYC Archive Catalog']</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">instantiationIDRegexPattern</td>
                                    <td>No namespace</td>
                                    <td>concat('^', $assetID, '\.[0-9]+$')</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">matchingInstantiationIDs</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">matchingInstantiationIdSuffixes</td>
                                    <td>No namespace</td>
                                    <td></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_M_pbcoreDescriptionDocumentM_maxInstantiationIDS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_M_pbcoreDescriptionDocumentM_maxInstantiationIDS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_M_pbcoreDescriptionDocumentM_maxInstantiationIDS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> match=</span><span class="tAV">"*:pbcoreDescriptionDocument"</span><span class="tAN"> mode=</span><span class="tAV">"maxInstantiationID"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"assetID"</span><span class="tAN"> select=</span><span class="tAV">"pbcoreIdentifier[@source = 'WNYC Archive Catalog']"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"instantiationIDRegexPattern"</span><span class="tAN"> select=</span><span class="tAV">"concat('^', $assetID, '\.[0-9]+$')"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"matchingInstantiationIDs"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tEl">&lt;matchingInstantiationIDs</span><span class="tEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"pbcoreInstantiation/instantiationIdentifier"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tEl">&lt;/matchingInstantiationIDs&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"matchingInstantiationIdSuffixes"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tEl">&lt;matchingInstantiationIDSuffixes</span><span class="tEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:for-each</span><span class="tAN"> select=</span><span class="tAV">"$matchingInstantiationIDs/instantiationIdentifier"</span><span class="tXSLEl">&gt;</span><span class="tI">
        </span><span class="tEl">&lt;instantiationIDSuffix</span><span class="tEl">&gt;</span><span class="tI">
          </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"xs:integer(substring-after(., '.'))"</span><span class="tXSLEl">/&gt;</span><span class="tI">
        </span><span class="tEl">&lt;/instantiationIDSuffix&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;/xsl:for-each&gt;</span><span class="tI">
    </span><span class="tEl">&lt;/matchingInstantiationIDSuffixes&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:param&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"'Find highes instantiation ID'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"maxInstSuffix"</span><span class="tAN"> select=</span><span class="tAV">"                 max($matchingInstantiationIdSuffixes/instantiationIDSuffix)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$maxInstSuffix"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"$maxInstSuffix"</span><span class="tXSLEl">/&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="M_pbpbcoreCollectionM_importReadyS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">pb:pbcoreCollection</span><span class="titleTemplateMode">importReady</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>pb:pbcoreCollection</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>importReady</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_M_pbpbcoreCollectionM_importReadyS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_M_pbpbcoreCollectionM_importReadyS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_M_pbpbcoreCollectionM_importReadyS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">copyUUID</td>
                                    <td>No namespace</td>
                                    <td>true()</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_M_pbpbcoreCollectionM_importReadyS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_M_pbpbcoreCollectionM_importReadyS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_M_pbpbcoreCollectionM_importReadyS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> match=</span><span class="tAV">"pb:pbcoreCollection"</span><span class="tAN"> mode=</span><span class="tAV">"importReady"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Get a collection ready for import into Cavafy --&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- ATTENTION: If you copy the UUID (the default), 
            it will create a whole new set of instantiations --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"copyUUID"</span><span class="tAN"> select=</span><span class="tAV">"true()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:copy</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:apply-templates</span><span class="tAN"> select=</span><span class="tAV">"                     pb:pbcoreDescriptionDocument"</span><span class="tAN"> mode=</span><span class="tAV">"importReady"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"copyUUID"</span><span class="tAN"> select=</span><span class="tAV">"$copyUUID"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:apply-templates&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:copy&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="M_pbpbcoreDescriptionDocumentM_importReadyS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">pb:pbcoreDescriptionDocument</span><span class="titleTemplateMode">importReady</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>pb:pbcoreDescriptionDocument</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>importReady</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_M_pbpbcoreDescriptionDocumentM_importReadyS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_M_pbpbcoreDescriptionDocumentM_importReadyS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_M_pbpbcoreDescriptionDocumentM_importReadyS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">copyUUID</td>
                                    <td>No namespace</td>
                                    <td>true()</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_M_pbpbcoreDescriptionDocumentM_importReadyS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_M_pbpbcoreDescriptionDocumentM_importReadyS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_M_pbpbcoreDescriptionDocumentM_importReadyS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> match=</span><span class="tAV">"pb:pbcoreDescriptionDocument"</span><span class="tAN"> mode=</span><span class="tAV">"importReady"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Get an asset ready for import into Cavafy --&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- ATTENTION: If you copy the UUID (the default), 
            it will wipe out all instantiations 
        and some of the asset fields --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"copyUUID"</span><span class="tAN"> select=</span><span class="tAV">"true()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 'ATTENTION: You are copying the UUID,              which wipes out all instantiations             and some of the asset fields'[$copyUUID]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:copy</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"comment()"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tC">&lt;!-- Copy asset level fields
            before UUID --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"*[following-sibling::pb:pbcoreIdentifier[@source = 'pbcore XML database UUID']]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tC">&lt;!-- Copy UUID, if flag says so --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"pb:pbcoreIdentifier[@source = 'pbcore XML database UUID'][$copyUUID]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tC">&lt;!-- Copy asset level fields after UUID
            except relation and instantiations --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"*                 [preceding-sibling::pb:pbcoreIdentifier[@source = 'pbcore XML database UUID']]                 [not(self::pb:pbcoreRelation)]                 [not(self::pb:pbcoreInstantiation)]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tC">&lt;!-- Copy relation sans @ref,
                    which somehow throws an error upon import --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:apply-templates</span><span class="tAN"> select=</span><span class="tAV">"                     pb:pbcoreRelation"</span><span class="tAN"> mode=</span><span class="tAV">"noAttributes"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tC">&lt;!-- Generate new instantiation section --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:apply-templates</span><span class="tAN"> select=</span><span class="tAV">"pb:pbcoreInstantiation"</span><span class="tAN"> mode=</span><span class="tAV">"importReady"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:copy&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="M_pbpbcoreInstantiationM_importReadyS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">pb:pbcoreInstantiation</span><span class="titleTemplateMode">importReady</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>pb:pbcoreInstantiation</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>importReady</td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_M_pbpbcoreInstantiationM_importReadyS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_M_pbpbcoreInstantiationM_importReadyS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_M_pbpbcoreInstantiationM_importReadyS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> match=</span><span class="tAV">"pb:pbcoreInstantiation"</span><span class="tAN"> mode=</span><span class="tAV">"importReady"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tC">&lt;!-- Get an instantiation ready for import into Cavafy --&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:copy</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tC">&lt;!-- Copy instantiation IDs except UUID and empty essence tracks --&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:copy-of</span><span class="tAN"> select=</span><span class="tAV">"                     *                     [not(self::pb:instantiationIdentifier[@source = 'pbcore XML database UUID'])]                     [not(self::pb:instantiationEssenceTrack[not(descendant::*)])]"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:copy&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="T_shortenTitleS_cavafySearch.xsl"></a><div class="cmpT">Template
         <span class="titleTemplateMatch">pb:pbcoreTitle[@titleType = 'Episode']</span><span class="titleTemplateName">shortenTitle</span><span class="titleTemplateMode">shortenTitle</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Match</td>
                        <td>pb:pbcoreTitle[@titleType = 'Episode']</td>
                     </tr>
                     <tr>
                        <td class="fCol">Mode</td>
                        <td>shortenTitle</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_T_shortenTitleS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_T_shortenTitleS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_T_shortenTitleS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter18.html#T_abbreviateTextS_trimStrings.xsl" target="_self" title="No namespace" onclick="updPT('trimStrings.xsl')"><span class="nRf">abbreviateText</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter18.html#T_substring-before-lastS_trimStrings.xsl" target="_self" title="No namespace" onclick="updPT('trimStrings.xsl')"><span class="nRf">substring-before-last</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Parameters</div>
                           <div class="flR"><input id="bt_prs_T_shortenTitleS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('prs_T_shortenTitleS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="prs_T_shortenTitleS_cavafySearch.xsl" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>QName</th>
                                       <th>Namespace</th>
                                       <th>Select</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td class="fCol">characterLength</td>
                                    <td>No namespace</td>
                                    <td>string-length($title)</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">maxTitleLength</td>
                                    <td>No namespace</td>
                                    <td>30</td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">title</td>
                                    <td>No namespace</td>
                                    <td>.</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">Import precedence</td>
                        <td>32</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_T_shortenTitleS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_T_shortenTitleS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_T_shortenTitleS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:template</span><span class="tAN"> name=</span><span class="tAV">"shortenTitle"</span><span class="tAN"> match=</span><span class="tAV">"pb:pbcoreTitle[@titleType = 'Episode']"</span><span class="tAN"> mode=</span><span class="tAV">"shortenTitle"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"title"</span><span class="tAN"> select=</span><span class="tAV">"."</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"maxTitleLength"</span><span class="tAN"> select=</span><span class="tAV">"30"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"characterLength"</span><span class="tAN"> select=</span><span class="tAV">"string-length($title)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 'Clean up and shorten title', $title,                 'to', $maxTitleLength, 'characters',                 'from', $characterLength, 'characters.'"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"cleanTitle"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"abbreviateText"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"maxTitleLength"</span><span class="tAN"> select=</span><span class="tAV">"                     $maxTitleLength"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"text"</span><span class="tAN"> select=</span><span class="tAV">"$title"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"                     analyze-string(                     replace(., '-', ' '),                     '[ A-Z a-z 0-9]')                     /*:match"</span><span class="tAN"> separator=</span><span class="tAV">""</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"trimmedTitle"</span><span class="tAN"> select=</span><span class="tAV">"                 substring(                 replace($cleanTitle, ' {2,}', ' ')                 , 1, $maxTitleLength)"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:variable</span><span class="tAN"> name=</span><span class="tAV">"shortTitle"</span><span class="tXSLEl">&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;xsl:call-template</span><span class="tAN"> name=</span><span class="tAV">"substring-before-last"</span><span class="tXSLEl">&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"input"</span><span class="tAN"> select=</span><span class="tAV">"                         $trimmedTitle"</span><span class="tXSLEl">/&gt;</span><span class="tI">
      </span><span class="tXSLEl">&lt;xsl:with-param</span><span class="tAN"> name=</span><span class="tAV">"substr"</span><span class="tAN"> select=</span><span class="tAV">"' '"</span><span class="tXSLEl">/&gt;</span><span class="tI">
    </span><span class="tXSLEl">&lt;/xsl:call-template&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;/xsl:variable&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:value-of</span><span class="tAN"> select=</span><span class="tAV">"$shortTitle"</span><span class="tXSLEl">/&gt;</span><span class="tI">
  </span><span class="tXSLEl">&lt;xsl:message</span><span class="tAN"> select=</span><span class="tAV">"                 'Short title:', $shortTitle"</span><span class="tXSLEl">/&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:template&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="P_cavafyValidatingStringS_cavafySearch.xsl"></a><div class="cmpT">Parameter
         <span class="qname">cavafyValidatingString</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Select</td>
                        <td>'https://cavafy.wnyc.org/assets/'</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_P_cavafyValidatingStringS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_P_cavafyValidatingStringS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_P_cavafyValidatingStringS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generatePbCoreCollectionS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generatePbCoreCollection</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generatePbCoreDescriptionDocument</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_P_cavafyValidatingStringS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_P_cavafyValidatingStringS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_P_cavafyValidatingStringS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"cavafyValidatingString"</span><span class="tAN"> select=</span><span class="tAV">"'https://cavafy.wnyc.org/assets/'"</span><span class="tXSLEl">/&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="P_separatingTokenS_cavafySearch.xsl"></a><div class="cmpT">Parameter
         <span class="qname">separatingToken</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Select</td>
                        <td>';'</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_P_separatingTokenS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_P_separatingTokenS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_P_separatingTokenS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter16.html#T_LOCOccupationsAndFieldsOfActivityS_processLoCURL.xsl" target="_self" title="No namespace" onclick="updPT('processLoCURL.xsl')"><span class="nRf">LOCOccupationsAndFieldsOfActivity</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter14.html#T_collectionsS_processCollection.xsl" target="_self" title="No namespace" onclick="updPT('processCollection.xsl')"><span class="nRf">collections</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter16.html#T_directLOCSearchS_processLoCURL.xsl" target="_self" title="No namespace" onclick="updPT('processLoCURL.xsl')"><span class="nRf">directLOCSearch</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generatePbCoreCollectionS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generatePbCoreCollection</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generatePbCoreCollectionWRepeatsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generatePbCoreCollectionWRepeats</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generatePbCoreDescriptionDocumentS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generatePbCoreDescriptionDocument</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateSearchStringS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateSearchString</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter1.html#T_newExifS_exif2NewExif.xsl" target="_self" title="No namespace" onclick="updPT('exif2NewExif.xsl')"><span class="nRf">newExif</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">Variables</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter16.html#V_separatingTokenLongS_processLoCURL.xsl" target="_self" title="No namespace" onclick="updPT('processLoCURL.xsl')">separatingTokenLong</a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter1.html#V_separatingTokenLongS_exif2NewExif.xsl" target="_self" title="No namespace" onclick="updPT('exif2NewExif.xsl')">separatingTokenLong</a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter17.html#V_separatingTokenLongS_manageDuplicates.xsl" target="_self" title="No namespace" onclick="updPT('manageDuplicates.xsl')">separatingTokenLong</a></div>
                                       </div>
                                    </td>
                                 </tr>
                                 <tr>
                                    <td class="fCol">Parameter</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_separatingTokenLongS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">separatingTokenLong</a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Supersedes</div>
                           <div class="flR"><input id="bt_sps_P_separatingTokenS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('sps_P_separatingTokenS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="sps_P_separatingTokenS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Variable</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter17.html#V_separatingTokenS_manageDuplicates.xsl" target="_self" title="No namespace" onclick="updPT('manageDuplicates.xsl')">separatingToken</a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_P_separatingTokenS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_P_separatingTokenS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_P_separatingTokenS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"separatingToken"</span><span class="tAN"> select=</span><span class="tAV">"';'"</span><span class="tXSLEl">/&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="P_separatingTokenLongS_cavafySearch.xsl"></a><div class="cmpT">Parameter
         <span class="qname">separatingTokenLong</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Select</td>
                        <td>concat(' ', $separatingToken, ' ')</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_P_separatingTokenLongS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_P_separatingTokenLongS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_P_separatingTokenLongS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Templates</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter16.html#T_LOCOccupationsAndFieldsOfActivityS_processLoCURL.xsl" target="_self" title="No namespace" onclick="updPT('processLoCURL.xsl')"><span class="nRf">LOCOccupationsAndFieldsOfActivity</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter15.html#T_defaultValuesWarningS_cavafyQC.xsl" target="_self" title="No namespace" onclick="updPT('cavafyQC.xsl')"><span class="nRf">defaultValuesWarning</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter16.html#T_directLOCSearchS_processLoCURL.xsl" target="_self" title="No namespace" onclick="updPT('processLoCURL.xsl')"><span class="nRf">directLOCSearch</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_findCavafyXMLsS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">findCavafyXMLs</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter17.html#T_mergeDataS_manageDuplicates.xsl" target="_self" title="No namespace" onclick="updPT('manageDuplicates.xsl')"><span class="nRf">mergeData</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter1.html#T_newExifS_exif2NewExif.xsl" target="_self" title="No namespace" onclick="updPT('exif2NewExif.xsl')"><span class="nRf">newExif</span></a><span class="refItemSep">;</span></div>
                                          <div class="refItemBlock"><a href="masterRouter20.html#M_pma_xml_exportS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="mRf">pma_xml_export</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">References</div>
                           <div class="flR"><input id="bt_refs_P_separatingTokenLongS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('refs_P_separatingTokenLongS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="refs_P_separatingTokenLongS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Parameter</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#P_separatingTokenS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')">separatingToken</a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Supersedes</div>
                           <div class="flR"><input id="bt_sps_P_separatingTokenLongS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('sps_P_separatingTokenLongS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="sps_P_separatingTokenLongS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Variable</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter17.html#V_separatingTokenLongS_manageDuplicates.xsl" target="_self" title="No namespace" onclick="updPT('manageDuplicates.xsl')">separatingTokenLong</a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_P_separatingTokenLongS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_P_separatingTokenLongS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_P_separatingTokenLongS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"separatingTokenLong"</span><span class="tAN"> select=</span><span class="tAV">"concat(' ', $separatingToken, ' ')"</span><span class="tXSLEl">/&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="P_acceptedSearchFieldsS_cavafySearch.xsl"></a><div class="cmpT">Parameter
         <span class="qname">acceptedSearchFields</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Used by</div>
                           <div class="flR"><input id="bt_uB_P_acceptedSearchFieldsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('uB_P_acceptedSearchFieldsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="uB_P_acceptedSearchFieldsS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Template</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter20.html#T_generateSearchStringS_cavafySearch.xsl" target="_self" title="No namespace" onclick="updPT('cavafySearch.xsl')"><span class="nRf">generateSearchString</span></a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_P_acceptedSearchFieldsS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_P_acceptedSearchFieldsS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_P_acceptedSearchFieldsS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"acceptedSearchFields"</span><span class="tXSLEl">&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">identifier</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">title</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">subject</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">description</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">genre</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">relation</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">coverage</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">audience+level</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">audience+rating</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">creator</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">contributor</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">publisher</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">rights</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">extension</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">location</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">annotation</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">date</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
  </span><span class="tEl">&lt;acceptedSearchField</span><span class="tEl">&gt;</span><span class="tT">format</span><span class="tEl">&lt;/acceptedSearchField&gt;</span><span class="tI">
</span><span class="tXSLEl">&lt;/xsl:param&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="P_todaysDateS_cavafySearch.xsl"></a><div class="cmpT">Parameter
         <span class="qname">todaysDate</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">Select</td>
                        <td>xs:date(current-date())</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Supersedes</div>
                           <div class="flR"><input id="bt_sps_P_todaysDateS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('sps_P_todaysDateS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="sps_P_todaysDateS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Parameter</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter2.html#P_todaysDateS_Exif2html.xsl" target="_self" title="No namespace" onclick="updPT('Exif2html.xsl')">todaysDate</a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Overriding</div>
                           <div class="flR"><input id="bt_ovr_P_todaysDateS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('ovr_P_todaysDateS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="ovr_P_todaysDateS_cavafySearch.xsl" style="display:block">
                              <table class="uBT">
                                 <tr>
                                    <td class="fCol">Parameter</td>
                                    <td>
                                       <div class="listGrouping">
                                          <div class="refItemBlock"><a href="masterRouter4.html#P_todaysDateS_Exif2Slack.xsl" target="_self" title="No namespace" onclick="updPT('Exif2Slack.xsl')">todaysDate</a></div>
                                       </div>
                                    </td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_P_todaysDateS_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_P_todaysDateS_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_P_todaysDateS_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:param</span><span class="tAN"> name=</span><span class="tAV">"todaysDate"</span><span class="tAN"> select=</span><span class="tAV">"xs:date(current-date())"</span><span class="tXSLEl">/&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table><a id="O_S_cavafySearch.xsl"></a><div class="cmpT">Output
         <span class="qname">(default)</span></div>
      <table class="rt">
         <tr>
            <td class="rt_cTL"></td>
            <td class="rt_lT"></td>
            <td class="rt_cTR"></td>
         </tr>
         <tr>
            <td class="rt_lL"></td>
            <td class="rt_cnt">
               <table class="component">
                  <tbody>
                     <tr>
                        <td class="fCol">Namespace</td>
                        <td>No namespace</td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Output properties</div>
                           <div class="flR"><input id="bt_o_" type="image" src="img/btM.gif" value="-" onclick="switchState('o_');" class="control" /></div>
                        </td>
                        <td>
                           <div id="o_" style="display:block">
                              <table class="attsT">
                                 <thead>
                                    <tr>
                                       <th>method</th>
                                       <th>encoding</th>
                                       <th>indent</th>
                                    </tr>
                                 </thead>
                                 <tr>
                                    <td></td>
                                    <td></td>
                                    <td>yes</td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                     <tr>
                        <td class="fCol">
                           <div class="flL">Source</div>
                           <div class="flR"><input id="bt_src_O_S_cavafySearch.xsl" type="image" src="img/btM.gif" value="-" onclick="switchState('src_O_S_cavafySearch.xsl');" class="control" /></div>
                        </td>
                        <td>
                           <div id="src_O_S_cavafySearch.xsl" style="display:block">
                              <table class="pWCont">
                                 <tr>
                                    <td width="100%"><pre><span class="tXSLEl">&lt;xsl:output</span><span class="tAN"> method=</span><span class="tAV">"xml"</span><span class="tAN"> version=</span><span class="tAV">"1.0"</span><span class="tAN"> indent=</span><span class="tAV">"yes"</span><span class="tXSLEl">/&gt;</span></pre></td>
                                 </tr>
                              </table>
                           </div>
                        </td>
                     </tr>
                  </tbody>
               </table>
            </td>
            <td class="rt_lR"></td>
         </tr>
         <tr>
            <td class="rt_cBL"></td>
            <td class="rt_lB"></td>
            <td class="rt_cBR"></td>
         </tr>
      </table>
      <div class="footer">
         <hr />
         <div align="center">Stylesheet documentation generated by <a href="http://www.oxygenxml.com" target="_parent"><span class="oXygenLogo"><span class="redX">&lt;</span>o<span class="redX">X</span>ygen<span class="redX">/&gt;</span></span></a><sup>®</sup> XML Editor.
         </div>
      </div><script type="text/javascript">
         <!--
                    // The namespace is the selected option in the TOC combo.
                    
                    // The corresponding div is already visible conf. to its style attr.                     
                    
                            var selectToc = getElementObject('selectTOC');
                            if(selectToc != null){
                            // It can be null when having chunking, the combo of the TOC is in another frame.
                            selectToc.selectedIndex = 0;
                            }
                        
                    
                    // Floats the toolbar.
                    var globalControls = getElementObject("global_controls"); 
                    
                    if(globalControls != null){
                    var browser=navigator.appName;
                    var version = parseFloat(navigator.appVersion.split('MSIE')[1]);
                    
                    var IE6 = false;
                    if ((browser=="Microsoft Internet Explorer") && (version < 7)){
                    IE6 = true;
                    }
                    
                    //alert (IE6 + " |V| " + version);
                    
                    if(IE6){
                    // On IE 6 the 'fixed' property is not supported. We must use javascript. 
                    globalControls.style.position='absolute';                         
                    // The global controls will do not exist in the TOC frame, when chunking.
                    findAndFloat("global_controls", 225, 30);    
                    } else {
                    globalControls.style.position='fixed';                     	
                    }
                    
                    globalControls.style.right='0';                       
                    }
                //--></script></body>
</html>